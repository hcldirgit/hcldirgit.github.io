<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>失落的乐章</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="失落的乐章的Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="失落的乐章">
<meta property="og:url" content="https://hcldirgit.github.io/page/46/index.html">
<meta property="og:site_name" content="失落的乐章">
<meta property="og:description" content="失落的乐章的Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="失落的乐章">
<meta name="twitter:description" content="失落的乐章的Blog">
  
    <link rel="alternative" href="/atom.xml" title="失落的乐章" type="application/atom+xml">
  
  
    <link rel="icon" href="https://github.com/hcldirgit/image/blob/master/0.png?raw=true">
  
  <link rel="stylesheet" href="/css/style.css">
  
  
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85415703-1', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://github.com/hcldirgit/image/blob/master/0.png?raw=true" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">失落的乐章</a></h1>
		</hgroup>

		
		<p class="header-subtitle">技术面前，永远都是学生。</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags">静心阅读</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Ansible/" style="font-size: 10.42px;">Ansible</a> <a href="/tags/Apache/" style="font-size: 18.33px;">Apache</a> <a href="/tags/Cacti/" style="font-size: 11.67px;">Cacti</a> <a href="/tags/DNS/" style="font-size: 13.33px;">DNS</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/FTP/" style="font-size: 11.25px;">FTP</a> <a href="/tags/Git/" style="font-size: 10.83px;">Git</a> <a href="/tags/HA集群/" style="font-size: 11.67px;">HA集群</a> <a href="/tags/Hadoop/" style="font-size: 12.5px;">Hadoop</a> <a href="/tags/Jenkins/" style="font-size: 10.42px;">Jenkins</a> <a href="/tags/LAMP/" style="font-size: 19.58px;">LAMP</a> <a href="/tags/LNMP/" style="font-size: 17.08px;">LNMP</a> <a href="/tags/LVS/" style="font-size: 16.67px;">LVS</a> <a href="/tags/Linux/" style="font-size: 19.17px;">Linux</a> <a href="/tags/Linux命令/" style="font-size: 20px;">Linux命令</a> <a href="/tags/Linux安全/" style="font-size: 14.17px;">Linux安全</a> <a href="/tags/Memcached/" style="font-size: 11.25px;">Memcached</a> <a href="/tags/MongoDB/" style="font-size: 15.42px;">MongoDB</a> <a href="/tags/MySQL/" style="font-size: 17.5px;">MySQL</a> <a href="/tags/NFS/" style="font-size: 10px;">NFS</a> <a href="/tags/Nagios/" style="font-size: 11.67px;">Nagios</a> <a href="/tags/Nginx/" style="font-size: 17.92px;">Nginx</a> <a href="/tags/OpenStack/" style="font-size: 11.25px;">OpenStack</a> <a href="/tags/Php/" style="font-size: 14.58px;">Php</a> <a href="/tags/Puppet/" style="font-size: 11.25px;">Puppet</a> <a href="/tags/Python/" style="font-size: 14.58px;">Python</a> <a href="/tags/Redis/" style="font-size: 16.25px;">Redis</a> <a href="/tags/Resin/" style="font-size: 10px;">Resin</a> <a href="/tags/Saltstack/" style="font-size: 10px;">Saltstack</a> <a href="/tags/Samba/" style="font-size: 12.08px;">Samba</a> <a href="/tags/Squid/" style="font-size: 14.58px;">Squid</a> <a href="/tags/Tomcat/" style="font-size: 13.75px;">Tomcat</a> <a href="/tags/Zabbix/" style="font-size: 15.83px;">Zabbix</a> <a href="/tags/haproxy/" style="font-size: 12.5px;">haproxy</a> <a href="/tags/keepalived/" style="font-size: 12.92px;">keepalived</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/shell练习/" style="font-size: 18.75px;">shell练习</a> <a href="/tags/正则表达式/" style="font-size: 12.92px;">正则表达式</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">失落的乐章</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://github.com/hcldirgit/image/blob/master/0.png?raw=true" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">失落的乐章</h1>
			</hgroup>
			
			<p class="header-subtitle">技术面前，永远都是学生。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags">静心阅读</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2. Linux 命令/62. Linux 命令- scp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/62. Linux 命令- scp/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.270Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/62. Linux 命令- scp/">
        Linux 命令- scp
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;scp是secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，不过cp只是在本机进行拷贝不能跨服务器，而且scp传输是加密的。可能会稍微影响一下速度。当你服务器硬盘变为只读 read only system时，用scp可以帮你把文件移出来。另外，scp还非常不占资源，不会提高多少系统负荷，在这一点上，rsync就远远不及它了。虽然 rsync比scp会快一点，但当小文件众多的情况下，rsync会导致硬盘I/O非常高，而scp基本不影响系统正常使用。</p>
<h2 id="1．命令格式"><a href="#1．命令格式" class="headerlink" title="1．命令格式"></a>1．命令格式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp [参数] [原路径] [目标路径]</div></pre></td></tr></table></figure>
<h2 id="2．命令功能"><a href="#2．命令功能" class="headerlink" title="2．命令功能"></a>2．命令功能</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;scp是 secure copy的缩写, scp是linux系统下基于ssh登陆进行安全的远程文件拷贝命令。linux的scp命令可以在linux服务器之间复制文件和目录。</p>
<h2 id="3．命令参数"><a href="#3．命令参数" class="headerlink" title="3．命令参数"></a>3．命令参数</h2><ul>
<li>-1  强制scp命令使用协议ssh1  </li>
<li>-2  强制scp命令使用协议ssh2  </li>
<li>-4  强制scp命令只使用IPv4寻址  </li>
<li>-6  强制scp命令只使用IPv6寻址  </li>
<li>-B  使用批处理模式（传输过程中不询问传输口令或短语）  </li>
<li>-C  允许压缩。（将-C标志传递给ssh，从而打开压缩功能）  </li>
<li>-p 保留原文件的修改时间，访问时间和访问权限。  </li>
<li>-q  不显示传输进度条。  </li>
<li>-r  递归复制整个目录。  </li>
<li>-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。   </li>
<li>-c cipher  以cipher将数据传输进行加密，这个选项将直接传递给ssh。   </li>
<li>-F ssh_config  指定一个替代的ssh配置文件，此参数直接传递给ssh。  </li>
<li>-i identity_file  从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。    </li>
<li>-l limit  限定用户所能使用的带宽，以Kbit/s为单位。     </li>
<li>-o ssh_option  如果习惯于使用ssh_config(5)中的参数传递方式，   </li>
<li>-P port  注意是大写的P, port是指定数据传输用到的端口号   </li>
<li>-S program  指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项。</li>
</ul>
<h2 id="4．使用实例"><a href="#4．使用实例" class="headerlink" title="4．使用实例"></a>4．使用实例</h2><h3 id="scp命令的实际应用概述："><a href="#scp命令的实际应用概述：" class="headerlink" title="scp命令的实际应用概述："></a>scp命令的实际应用概述：</h3><h4 id="从本地服务器复制到远程服务器："><a href="#从本地服务器复制到远程服务器：" class="headerlink" title="从本地服务器复制到远程服务器："></a>从本地服务器复制到远程服务器：</h4><h5 id="1-复制文件："><a href="#1-复制文件：" class="headerlink" title="(1) 复制文件："></a>(1) 复制文件：</h5><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;命令格式：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp local_file remote_username@remote_ip:remote_folder</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;或者  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp local_file remote_username@remote_ip:remote_file</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;或者  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp local_file remote_ip:remote_folder</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;或者  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp local_file remote_ip:remote_file</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;第1,2个指定了用户名，命令执行后需要输入用户密码，第1个仅指定了远程的目录，文件名字不变，第2个指定了文件名</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;第3,4个没有指定用户名，命令执行后需要输入用户名和密码，第3个仅指定了远程的目录，文件名字不变，第4个指定了文件名   </p>
<h5 id="2-复制目录："><a href="#2-复制目录：" class="headerlink" title="(2) 复制目录："></a>(2) 复制目录：</h5><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;命令格式：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp -r local_folder remote_username@remote_ip:remote_folder</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;或者  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp -r local_folder remote_ip:remote_folder</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;第1个指定了用户名，命令执行后需要输入用户密码；</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;第2个没有指定用户名，命令执行后需要输入用户名和密码；</p>
<h4 id="从远程服务器复制到本地服务器："><a href="#从远程服务器复制到本地服务器：" class="headerlink" title="从远程服务器复制到本地服务器："></a>从远程服务器复制到本地服务器：</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;从远程复制到本地的scp命令与上面的命令雷同，只要将从本地复制到远程的命令后面2个参数互换顺序就行了。</p>
<h3 id="实例1：从远处复制文件到本地目录"><a href="#实例1：从远处复制文件到本地目录" class="headerlink" title="实例1：从远处复制文件到本地目录"></a>实例1：从远处复制文件到本地目录</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp root@192.168.120.204:/opt/soft/nginx-0.5.38.tar.gz /opt/soft/</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># cd /opt/soft/</span></div><div class="line">[root@localhost soft]<span class="comment"># ll</span></div><div class="line">总计 80072</div><div class="line">drwxr-xr-x 12 root root     4096 09-21 18:40 fms3.5</div><div class="line">drwxr-xr-x  3 root root     4096 09-21 17:58 fms4.5</div><div class="line">drwxr-xr-x 10 root root     4096 10-30 17:15 jdk1.6.0_16</div><div class="line">drwxr-xr-x 10 root root     4096 09-17 19:27 jdk1.6.0_16.bak</div><div class="line">-rwxr-xr-x  1 root root 81871260 2009-12-21 jdk-6u16-linux-x64.bin</div><div class="line">drwxrwxrwx  2 root root     4096 09-21 01:16 mysql</div><div class="line">drwxr-xr-x  3 root root     4096 09-21 18:40 setup_file</div><div class="line">drwxr-xr-x  9 root root     4096 09-17 19:23 tomcat6.0.32</div><div class="line">drwxr-xr-x  9 root root     4096 2012-08-14 tomcat_7.0</div><div class="line">[root@localhost soft]<span class="comment"># scp root@192.168.120.204:/opt/soft/nginx-0.5.38.tar.gz /opt/soft/</span></div><div class="line">root@192.168.120.204<span class="string">'s password: </span></div><div class="line"><span class="string">nginx-0.5.38.tar.gz                                                                               100%  479KB 478.7KB/s   00:00    </span></div><div class="line"><span class="string">[root@localhost soft]# ll</span></div><div class="line"><span class="string">总计 80556</span></div><div class="line"><span class="string">drwxr-xr-x 12 root root     4096 09-21 18:40 fms3.5</span></div><div class="line"><span class="string">drwxr-xr-x  3 root root     4096 09-21 17:58 fms4.5</span></div><div class="line"><span class="string">drwxr-xr-x 10 root root     4096 10-30 17:15 jdk1.6.0_16</span></div><div class="line"><span class="string">drwxr-xr-x 10 root root     4096 09-17 19:27 jdk1.6.0_16.bak</span></div><div class="line"><span class="string">-rwxr-xr-x  1 root root 81871260 2009-12-21 jdk-6u16-linux-x64.bin</span></div><div class="line"><span class="string">drwxrwxrwx  2 root root     4096 09-21 01:16 mysql</span></div><div class="line"><span class="string">-rw-r--r--  1 root root   490220 03-15 09:11 nginx-0.5.38.tar.gz</span></div><div class="line"><span class="string">drwxr-xr-x  3 root root     4096 09-21 18:40 setup_file</span></div><div class="line"><span class="string">drwxr-xr-x  9 root root     4096 09-17 19:23 tomcat6.0.32</span></div><div class="line"><span class="string">drwxr-xr-x  9 root root     4096 2012-08-14 tomcat_7.0</span></div><div class="line"><span class="string">[root@localhost soft]#</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;从192.168.120.204机器上的/opt/soft/的目录中下载nginx-0.5.38.tar.gz 文件到本地/opt/soft/目录中</p>
<h3 id="实例2：从远处复制到本地"><a href="#实例2：从远处复制到本地" class="headerlink" title="实例2：从远处复制到本地"></a>实例2：从远处复制到本地</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp -r root@192.168.120.204:/opt/soft/mongodb /opt/soft/</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">[root@localhost soft]<span class="comment"># ll</span></div><div class="line">总计 80556</div><div class="line">drwxr-xr-x 12 root root     4096 09-21 18:40 fms3.5</div><div class="line">drwxr-xr-x  3 root root     4096 09-21 17:58 fms4.5</div><div class="line">drwxr-xr-x 10 root root     4096 10-30 17:15 jdk1.6.0_16</div><div class="line">drwxr-xr-x 10 root root     4096 09-17 19:27 jdk1.6.0_16.bak</div><div class="line">-rwxr-xr-x  1 root root 81871260 2009-12-21 jdk-6u16-linux-x64.bin</div><div class="line">drwxrwxrwx  2 root root     4096 09-21 01:16 mysql</div><div class="line">-rw-r--r--  1 root root   490220 03-15 09:11 nginx-0.5.38.tar.gz</div><div class="line">drwxr-xr-x  3 root root     4096 09-21 18:40 setup_file</div><div class="line">drwxr-xr-x  9 root root     4096 09-17 19:23 tomcat6.0.32</div><div class="line">drwxr-xr-x  9 root root     4096 2012-08-14 tomcat_7.0</div><div class="line">[root@localhost soft]<span class="comment"># scp -r root@192.168.120.204:/opt/soft/mongodb /opt/soft/</span></div><div class="line">root@192.168.120.204<span class="string">'s password: </span></div><div class="line"><span class="string">mongodb-linux-i686-static-1.8.5.tgz                                                               100%   28MB  28.3MB/s   00:01    </span></div><div class="line"><span class="string">README                                                                                            100%  731     0.7KB/s   00:00    </span></div><div class="line"><span class="string">THIRD-PARTY-NOTICES                                                                               100% 7866     7.7KB/s   00:00    </span></div><div class="line"><span class="string">mongorestore                                                                                      100% 7753KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongod                                                                                            100% 7760KB   7.6MB/s   00:01    </span></div><div class="line"><span class="string">mongoexport                                                                                       100% 7744KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">bsondump                                                                                          100% 7737KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongofiles                                                                                        100% 7748KB   7.6MB/s   00:01    </span></div><div class="line"><span class="string">mongostat                                                                                         100% 7808KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongos                                                                                            100% 5262KB   5.1MB/s   00:01    </span></div><div class="line"><span class="string">mongo                                                                                             100% 3707KB   3.6MB/s   00:00    </span></div><div class="line"><span class="string">mongoimport                                                                                       100% 7754KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongodump                                                                                         100% 7773KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">GNU-AGPL-3.0                                                                                      100%   34KB  33.7KB/s   00:00    </span></div><div class="line"><span class="string">[root@localhost soft]# ll</span></div><div class="line"><span class="string">总计 80560</span></div><div class="line"><span class="string">drwxr-xr-x 12 root root     4096 09-21 18:40 fms3.5</span></div><div class="line"><span class="string">drwxr-xr-x  3 root root     4096 09-21 17:58 fms4.5</span></div><div class="line"><span class="string">drwxr-xr-x 10 root root     4096 10-30 17:15 jdk1.6.0_16</span></div><div class="line"><span class="string">drwxr-xr-x 10 root root     4096 09-17 19:27 jdk1.6.0_16.bak</span></div><div class="line"><span class="string">-rwxr-xr-x  1 root root 81871260 2009-12-21 jdk-6u16-linux-x64.bin</span></div><div class="line"><span class="string">drwxr-xr-x  3 root root     4096 03-15 09:18 mongodb</span></div><div class="line"><span class="string">drwxrwxrwx  2 root root     4096 09-21 01:16 mysql</span></div><div class="line"><span class="string">-rw-r--r--  1 root root   490220 03-15 09:11 nginx-0.5.38.tar.gz</span></div><div class="line"><span class="string">drwxr-xr-x  3 root root     4096 09-21 18:40 setup_file</span></div><div class="line"><span class="string">drwxr-xr-x  9 root root     4096 09-17 19:23 tomcat6.0.32</span></div><div class="line"><span class="string">drwxr-xr-x  9 root root     4096 2012-08-14 tomcat_7.0</span></div><div class="line"><span class="string">[root@localhost soft]#</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;从192.168.120.204机器上的/opt/soft/中下载mongodb 目录到本地的/opt/soft/目录来。</p>
<h3 id="实例3：上传本地文件到远程机器指定目录"><a href="#实例3：上传本地文件到远程机器指定目录" class="headerlink" title="实例3：上传本地文件到远程机器指定目录"></a>实例3：上传本地文件到远程机器指定目录</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp /opt/soft/nginx-0.5.38.tar.gz root@192.168.120.204:/opt/soft/scptest</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">上传前目标机器的目标目录：</div><div class="line">[root@localhost soft]<span class="comment"># cd scptest/</span></div><div class="line">[root@localhost scptest]<span class="comment"># ll</span></div><div class="line">总计 0</div><div class="line">[root@localhost scptest]<span class="comment"># ll</span></div><div class="line"></div><div class="line">本地机器上传：</div><div class="line">[root@localhost soft]<span class="comment"># scp /opt/soft/nginx-0.5.38.tar.gz root@192.168.120.204:/opt/soft/scptest</span></div><div class="line">root@192.168.120.204<span class="string">'s password: </span></div><div class="line"><span class="string">nginx-0.5.38.tar.gz                                                                               100%  479KB 478.7KB/s   00:00    </span></div><div class="line"><span class="string">[root@localhost soft]# </span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">上传后目标机器的目标目录：</span></div><div class="line"><span class="string">[root@localhost scptest]# ll</span></div><div class="line"><span class="string">总计 484</span></div><div class="line"><span class="string">-rw-r--r-- 1 root root 490220 03-15 09:25 nginx-0.5.38.tar.gz</span></div><div class="line"><span class="string">[root@localhost scptest]#</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;复制本地opt/soft/目录下的文件nginx-0.5.38.tar.gz 到远程机器192.168.120.204的opt/soft/scptest目录</p>
<h3 id="实例4：上传本地目录到远程机器指定目录"><a href="#实例4：上传本地目录到远程机器指定目录" class="headerlink" title="实例4：上传本地目录到远程机器指定目录"></a>实例4：上传本地目录到远程机器指定目录</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp -r /opt/soft/mongodb root@192.168.120.204:/opt/soft/scptest</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">上传前目标机器的目标目录：</div><div class="line">[root@localhost ~]<span class="comment"># cd /opt/soft/scptest/</span></div><div class="line">[root@localhost scptest]<span class="comment"># ll</span></div><div class="line">总计 484</div><div class="line">-rw-r--r-- 1 root root 490220 03-15 09:25 nginx-0.5.38.tar.gz</div><div class="line">[root@localhost scptest]<span class="comment"># </span></div><div class="line">本地机器上传：</div><div class="line">[root@localhost ~]<span class="comment"># scp -r /opt/soft/mongodb root@192.168.120.204:/opt/soft/scptest</span></div><div class="line">root@192.168.120.204<span class="string">'s password: </span></div><div class="line"><span class="string">mongodb-linux-i686-static-1.8.5.tgz                                                               100%   28MB  28.3MB/s   00:01    </span></div><div class="line"><span class="string">README                                                                                            100%  731     0.7KB/s   00:00    </span></div><div class="line"><span class="string">THIRD-PARTY-NOTICES                                                                               100% 7866     7.7KB/s   00:00    </span></div><div class="line"><span class="string">mongorestore                                                                                      100% 7753KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongod                                                                                            100% 7760KB   7.6MB/s   00:01    </span></div><div class="line"><span class="string">mongoexport                                                                                       100% 7744KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">bsondump                                                                                          100% 7737KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongofiles                                                                                        100% 7748KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">mongostat                                                                                         100% 7808KB   7.6MB/s   00:01    </span></div><div class="line"><span class="string">mongos                                                                                            100% 5262KB   5.1MB/s   00:00    </span></div><div class="line"><span class="string">mongo                                                                                             100% 3707KB   3.6MB/s   00:00    </span></div><div class="line"><span class="string">mongoimport                                                                                       100% 7754KB   7.6MB/s   00:01    </span></div><div class="line"><span class="string">mongodump                                                                                         100% 7773KB   7.6MB/s   00:00    </span></div><div class="line"><span class="string">GNU-AGPL-3.0                                                                                      100%   34KB  33.7KB/s   00:00    </span></div><div class="line"><span class="string">[root@localhost ~]# </span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">上传后目标机器的目标目录：</span></div><div class="line"><span class="string">[root@localhost scptest]# ll</span></div><div class="line"><span class="string">总计 488</span></div><div class="line"><span class="string">drwxr-xr-x 3 root root   4096 03-15 09:33 mongodb</span></div><div class="line"><span class="string">-rw-r--r-- 1 root root 490220 03-15 09:25 nginx-0.5.38.tar.gz</span></div><div class="line"><span class="string">[root@localhost scptest]#</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;上传本地目录 /opt/soft/mongodb到远程机器192.168.120.204上/opt/soft/scptest的目录中去</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/31. group 文件详解" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/31. group 文件详解/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.269Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/31. group 文件详解/">
        /etc/group 文件详解
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Linux /etc/group文件与/etc/passwd和/etc/shadow文件都是有关于系统管理员对用户和用户组管理时相关的文件。linux /etc/group文件是有关于系统管理员对用户和用户组管理的文件,linux用户组的所有信息都存放在/etc/group文件中。具有某种共同特征的用户集合起来就是用户组（Group）。用户组（Group）配置文件主要有 /etc/group和/etc/gshadow，其中/etc/gshadow是/etc/group的加密信息文件。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;将用户分组是Linux系统中对用户进行管理及控制访问权限的一种手段。每个用户都属于某个用户组；一个组中可以有多个用户，一个用户也可以属于不 同的组。当一个用户同时是多个组中的成员时，在/etc/passwd文件中记录的是用户所属的主组，也就是登录时所属的默认组，而其他组称为附加组。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;用户组的所有信息都存放在/etc/group文件中。此文件的格式是由冒号(:)隔开若干个字段，这些字段具体如下：</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;组名:口令:组标识号:组内用户列表</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;具体解释：</p>
<h2 id="组名"><a href="#组名" class="headerlink" title="组名"></a>组名</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;组名是用户组的名称，有字母或数字构成。与 /etc/passwd 中的登录名一样，组名不应重复</p>
<h2 id="口令"><a href="#口令" class="headerlink" title="口令"></a>口令</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;口令字段存放在用户组加密后的口令字。一般 Linux 系统的用户组都没有口令，即这个字段一般为空，或者是 * 。</p>
<h2 id="组标识号"><a href="#组标识号" class="headerlink" title="组标识号"></a>组标识号</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;组标识号与用户标识号类似，也是一个证书，被系统内部用来标识组。别称 GID 。</p>
<h2 id="组内用户列表"><a href="#组内用户列表" class="headerlink" title="组内用户列表"></a>组内用户列表</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;是属于这个组的所有用户的列表，不同用户之间用逗号（，）分隔。这个用户组可能是用户的主组，也可能是附加组。</p>
<h2 id="使用实例"><a href="#使用实例" class="headerlink" title="使用实例"></a>使用实例</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@localhost test6]<span class="comment"># cat /etc/group</span></div><div class="line">root:x:0:root,linuxsir</div><div class="line">bin:x:1:root,bin,daemon</div><div class="line">daemon:x:2:root,bin,daemon</div><div class="line">sys:x:3:root,bin</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;以 root:x:0:root,linuxsir 为例：用户组 root ，x 是密码段，表示没有设置木马，GID 是 0 ，root 用户组下包括 root、linuxsir 以及 GID 为0的其它用户。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/70. Linux 命令- sed" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/70. Linux 命令- sed/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.268Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/70. Linux 命令- sed/">
        Linux 命令- sed
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 命令是利用 script 来处理文本文件。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 可依照 script 的指令来处理、编辑文本文件。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 可以实现 grep 的大部分功能，而且还可以查找替换。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 跟 grep 一样，不识别 + 、| 、｛｝、 （）等符号，需要借助脱义符号 、 或者使用选项 -r</p>
<h2 id="1-命令语法"><a href="#1-命令语法" class="headerlink" title="1. 命令语法"></a>1. 命令语法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sed [-hnV] [-e&lt;script&gt;] [-f&lt;script文件&gt;] [文本文件]</div></pre></td></tr></table></figure>
<h2 id="2-命令参数"><a href="#2-命令参数" class="headerlink" title="2. 命令参数"></a>2. 命令参数</h2><ul>
<li>-e <code>&lt;script&gt;或--expression=&lt;script&gt;</code> 以选项中指定的script来处理输入的文本文件。</li>
<li>-f <script文件>或–file=<script文件> 以选项中指定的script文件来处理输入的文本文件。</script文件></script文件></li>
<li>-h 或–help 显示帮助。</li>
<li>-n 或–quiet或–silent 仅显示script处理后的结果。</li>
<li>-V 或–version 显示版本信息。</li>
</ul>
<h2 id="3-命令动作"><a href="#3-命令动作" class="headerlink" title="3. 命令动作"></a>3. 命令动作</h2><ul>
<li>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～</li>
<li>c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</li>
<li>d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；</li>
<li>i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</li>
<li>p ：列印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～</li>
<li>s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！</li>
</ul>
<h2 id="4-使用实例"><a href="#4-使用实例" class="headerlink" title="4.使用实例"></a>4.使用实例</h2><h3 id="实例1：在-testfile-文件的第四行后添加一行，并将结果输出到标准输出"><a href="#实例1：在-testfile-文件的第四行后添加一行，并将结果输出到标准输出" class="headerlink" title="实例1：在 testfile 文件的第四行后添加一行，并将结果输出到标准输出"></a>实例1：在 testfile 文件的第四行后添加一行，并将结果输出到标准输出</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sed -e 4a \newLine testfile</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ cat testfile </div><div class="line">HELLO LINUX!  </div><div class="line">Linux is a free unix-type opterating system.  </div><div class="line">This is a linux testfile!  </div><div class="line">Linux <span class="built_in">test</span> </div><div class="line">$ sed -e 4a\newline testfile </div><div class="line">HELLO LINUX!   </div><div class="line">Linux is a free unix-type opterating system.  </div><div class="line">This is a linux testfile!  </div><div class="line">Linux <span class="built_in">test</span>  </div><div class="line">newline</div></pre></td></tr></table></figure>
<h2 id="实例2：将-etc-passwd-的内容列出并且列印行号，同时将第2-5行删除"><a href="#实例2：将-etc-passwd-的内容列出并且列印行号，同时将第2-5行删除" class="headerlink" title="实例2：将 /etc/passwd 的内容列出并且列印行号，同时将第2-5行删除"></a>实例2：将 /etc/passwd 的内容列出并且列印行号，同时将第2-5行删除</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'2,5d'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd|sed '2,5d'</span></div><div class="line">     1  root:x:0:0:root:/root:/bin/bash</div><div class="line">     6  sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div><div class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</div><div class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</div><div class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</div><div class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</div><div class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</div><div class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</div><div class="line">    14  systemd-bus-proxy:x:999:997:systemd Bus Proxy:/:/sbin/nologin</div><div class="line">    15  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</div><div class="line">    16  dbus:x:81:81:System message bus:/:/sbin/nologin</div><div class="line">    17  polkitd:x:998:996:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</div><div class="line">    18  tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</div><div class="line">    19  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</div><div class="line">    20  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</div><div class="line">    21  chrony:x:997:995::/var/lib/chrony:/sbin/nologin</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;以行为单位的删除，sed 的动作为 ‘2,5d’，那个 d 就是删除。因为 2-5 行给删除了，所以显示的数据就没有 2-5 行。另外，注意一下，原本应该是要下达 -e 才对，没有 -e 也可以。同时也要注意的是，sed 后面接的动作务必以 ‘’单引号括住。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;只要删除第2行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'2d'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;要删除第3到最后一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd |sed <span class="string">'3,$d'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;在第2行后，第3行上加上 ‘drink tea’ 字样</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'2a drink tea'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;如果要加再第2行前</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'2i drink tea'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;如果要在第2行后面加入两行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'2a drink tea \</span></div><div class="line"><span class="string">&gt; drink beer'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;每一行之间都必须要以反斜杠（\）来进行新行的添加</p>
<h3 id="实例3：将第2-5行内容取代成为‘2-5-number’"><a href="#实例3：将第2-5行内容取代成为‘2-5-number’" class="headerlink" title="实例3：将第2-5行内容取代成为‘2-5 number’"></a>实例3：将第2-5行内容取代成为‘2-5 number’</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'2,5c 2-5 number'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed '2,5c 2-5 number'</span></div><div class="line">     1  root:x:0:0:root:/root:/bin/bash</div><div class="line">2-5 number</div><div class="line">     6  sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div><div class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</div><div class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</div><div class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</div><div class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</div><div class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</div><div class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</div><div class="line">    14  systemd-bus-proxy:x:999:997:systemd Bus Proxy:/:/sbin/nologin</div><div class="line">    15  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</div><div class="line">    16  dbus:x:81:81:System message bus:/:/sbin/nologin</div><div class="line">    17  polkitd:x:998:996:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</div><div class="line">    18  tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</div><div class="line">    19  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</div><div class="line">    20  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</div><div class="line">    21  chrony:x:997:995::/var/lib/chrony:/sbin/nologin</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;以行为单位的替换与显示，通过这个方法就能够将数据整行取代了。</p>
<h3 id="实例4：仅列出-etc-passwd-文件内的5-7-行"><a href="#实例4：仅列出-etc-passwd-文件内的5-7-行" class="headerlink" title="实例4：仅列出 /etc/passwd 文件内的5-7 行"></a>实例4：仅列出 /etc/passwd 文件内的5-7 行</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd |sed -n <span class="string">'5,7p'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -n '5,7p'</span></div><div class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</div><div class="line">     6  sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong><br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;如果 root 找到，处理输出所有行，还回输出匹配行。<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;使用 -n 的时候将只打印包含模版的行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -n '/root/p'</span></div><div class="line">     1  root:x:0:0:root:/root:/bin/bash</div><div class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</div></pre></td></tr></table></figure>
<h3 id="实例5：删除-etc-paawd-所有包含-root-的行，其他行输出"><a href="#实例5：删除-etc-paawd-所有包含-root-的行，其他行输出" class="headerlink" title="实例5：删除 /etc/paawd 所有包含 root 的行，其他行输出"></a>实例5：删除 /etc/paawd 所有包含 root 的行，其他行输出</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed <span class="string">'/root/d'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed '/root/d'</span></div><div class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</div><div class="line">     3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</div><div class="line">     4  adm:x:3:4:adm:/var/adm:/sbin/nologin</div><div class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</div><div class="line">     6  sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div><div class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</div><div class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</div><div class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</div><div class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</div><div class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</div><div class="line">    14  systemd-bus-proxy:x:999:997:systemd Bus Proxy:/:/sbin/nologin</div><div class="line">    15  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</div><div class="line">    16  dbus:x:81:81:System message bus:/:/sbin/nologin</div><div class="line">    17  polkitd:x:998:996:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</div><div class="line">    18  tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</div><div class="line">    19  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</div><div class="line">    20  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</div><div class="line">    21  chrony:x:997:995::/var/lib/chrony:/sbin/nologin</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;数据的搜寻并删除</p>
<h3 id="实例6：搜索-etc-passwd-找到-root-对应的行，执行后面花括号中的命令，每个命令之间用分号分割，并把bash替换为blueshell，在输出这行"><a href="#实例6：搜索-etc-passwd-找到-root-对应的行，执行后面花括号中的命令，每个命令之间用分号分割，并把bash替换为blueshell，在输出这行" class="headerlink" title="实例6：搜索 /etc/passwd 找到 root 对应的行，执行后面花括号中的命令，每个命令之间用分号分割，并把bash替换为blueshell，在输出这行"></a>实例6：搜索 /etc/passwd 找到 root 对应的行，执行后面花括号中的命令，每个命令之间用分号分割，并把bash替换为blueshell，在输出这行</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed -n <span class="string">'/bash/ &#123;s/bash/blueshell/;p;q&#125;'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -n '/bash/ &#123;s/bash/blueshell/;p;q&#125;'</span></div><div class="line">     1  root:x:0:0:root:/root:/bin/blueshell</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;数据的搜寻并执行命令，最后的q是退出</p>
<h3 id="实例7：查找-etc-passwd-内-root-的行，并把-root-替换为-shell"><a href="#实例7：查找-etc-passwd-内-root-的行，并把-root-替换为-shell" class="headerlink" title="实例7：查找 /etc/passwd 内 root 的行，并把 root 替换为 shell"></a>实例7：查找 /etc/passwd 内 root 的行，并把 root 替换为 shell</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sed <span class="string">'s/root/shell/g'</span> /etc/passwd</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># sed 's/root/shell/g' /etc/passwd</span></div><div class="line">shell:x:0:0:shell:/shell:/bin/bash</div><div class="line">bin:x:1:1:bin:/bin:/sbin/nologin</div><div class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</div><div class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</div><div class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</div><div class="line">sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div><div class="line">halt:x:7:0:halt:/sbin:/sbin/halt</div><div class="line">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</div><div class="line">operator:x:11:0:operator:/shell:/sbin/nologin</div><div class="line">games:x:12:100:games:/usr/games:/sbin/nologin</div><div class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</div><div class="line">nobody:x:99:99:Nobody:/:/sbin/nologin</div><div class="line">systemd-bus-proxy:x:999:997:systemd Bus Proxy:/:/sbin/nologin</div><div class="line">systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</div><div class="line">dbus:x:81:81:System message bus:/:/sbin/nologin</div><div class="line">polkitd:x:998:996:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</div><div class="line">tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</div><div class="line">postfix:x:89:89::/var/spool/postfix:/sbin/nologin</div><div class="line">sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</div><div class="line">chrony:x:997:995::/var/lib/chrony:/sbin/nologin</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;数据的搜寻并替换，s 就是替换的意思，g 为全局替换，否则只替换一次。</p>
<h3 id="实例8：使用-ifconfig-查看ip地址，并提取出ip地址"><a href="#实例8：使用-ifconfig-查看ip地址，并提取出ip地址" class="headerlink" title="实例8：使用 ifconfig 查看ip地址，并提取出ip地址"></a>实例8：使用 ifconfig 查看ip地址，并提取出ip地址</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;先使用 ifconfig 命令查询eth0网卡ip</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># ifconfig eth0</span></div><div class="line">eth0      Link encap:Ethernet  HWaddr 00:0C:29:4D:9F:F7  </div><div class="line">          inet addr:192.168.0.73  Bcast:192.168.0.255  Mask:255.255.255.0</div><div class="line">          inet6 addr: fe80::20c:29ff:fe4d:9ff7/64 Scope:Link</div><div class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</div><div class="line">          RX packets:41 errors:0 dropped:0 overruns:0 frame:0</div><div class="line">          TX packets:48 errors:0 dropped:0 overruns:0 carrier:0</div><div class="line">          collisions:0 txqueuelen:1000 </div><div class="line">          RX bytes:4525 (4.4 KiB)  TX bytes:5868 (5.7 KiB)</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ifconfig eth0 | grep <span class="string">'inet addr'</span> | sed <span class="string">'s/^.*addr://g'</span> | sed <span class="string">'s/Bcast.*$//g'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ifconfig eth0 | grep <span class="string">'inet addr'</span> | sed <span class="string">'s/^.*addr://g'</span> | sed <span class="string">'s/Bcast.*$//g'</span></div><div class="line">192.168.0.73</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;数据的搜寻并替换，先观察原始信息，利用 ficonfig 查询 eth0 网卡 ip，再用 sed 命令将 ip 前面的部分删除（就是把前面的部分替换为空），接下来是删除后续的部分（把后续部分替换为空）</p>
<h3 id="实例9：删除-etc-passwd-第3行到末尾的数据，并把bash-替换为-blueshell"><a href="#实例9：删除-etc-passwd-第3行到末尾的数据，并把bash-替换为-blueshell" class="headerlink" title="实例9：删除 /etc/passwd 第3行到末尾的数据，并把bash 替换为 blueshell"></a>实例9：删除 /etc/passwd 第3行到末尾的数据，并把bash 替换为 blueshell</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nl /etc/passwd | sed -e <span class="string">'3,$d'</span> -e <span class="string">'s/bash/blueshell/g'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -e '3,$d' -e 's/bash/blueshell/g'</span></div><div class="line"></div><div class="line">     1  root:x:0:0:root:/root:/bin/blueshell</div><div class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;多点编辑，-e 表示多点编辑，第一个编辑命令删除 /etc/passwd 第三行到末行的数据，第二条命令搜索 bash 替换为 blueshell</p>
<h3 id="实例10：直接修改文件内容（危险动作）"><a href="#实例10：直接修改文件内容（危险动作）" class="headerlink" title="实例10：直接修改文件内容（危险动作）"></a>实例10：直接修改文件内容（危险动作）</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 可以直接修改文件的内容，不必使用管道命令或数据流重定向。不过，由于这个动作会直接修改到原始的文件，所以千万不要随便拿系统配置文件来测试!</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;先用 cp 命令拷贝一份/etc/passwd 文件为 1.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># cp /etc/passwd 1.txt</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;删除所有非数字</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># sed -i 's/[^0-9]//g' 1.txt</span></div><div class="line">[root@localhost ~]<span class="comment"># cat 1.txt</span></div><div class="line">00</div><div class="line">11</div><div class="line">22</div><div class="line">34</div><div class="line">47</div><div class="line">50</div><div class="line">60</div><div class="line">70</div><div class="line">812</div><div class="line">110</div><div class="line">12100</div><div class="line">1450</div><div class="line">9999</div><div class="line">999997</div><div class="line">192192</div><div class="line">8181</div><div class="line">998996</div><div class="line">5959</div><div class="line">8989</div><div class="line">7474</div><div class="line">997995</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sed 的 -i 选项可以直接修改文件内容，这功能非常有帮助！举例来说，如果有一个100万行的文件，要在第100行加某些文字，此时使用 vim 可能会疯掉！因为文件太大了！就利用 sed ，通过 sed 直接修改、取代的功能，甚至不用使用 vim 去修订。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/正则表达式/">正则表达式</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/38. Linux 命令- diff" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/38. Linux 命令- diff/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.259Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/38. Linux 命令- diff/">
        Linux 命令- diff
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;diff 命令是 linux上非常重要的工具，用于比较文件的内容，特别是比较两个版本不同的文件以找到改动的地方。diff在命令行中打印每一个行的改动。最新版本的diff还支持二进制文件。diff程序的输出被称为补丁 (patch)，因为Linux系统中还有一个patch程序，可以根据diff的输出将a.c的文件内容更新为b.c。diff是svn、cvs、git等版本控制工具不可或缺的一部分。</p>
<h2 id="1．命令格式"><a href="#1．命令格式" class="headerlink" title="1．命令格式"></a>1．命令格式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff [参数] [文件1或目录1] [文件2或目录2]</div></pre></td></tr></table></figure>
<h2 id="2．命令功能"><a href="#2．命令功能" class="headerlink" title="2．命令功能"></a>2．命令功能</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;diff命令能比较单个文件或者目录内容。如果指定比较的是文件，则只有当输入为文本文件时才有效。以逐行的方式，比较文本文件的异同处。如果指定比较的是目录的的时候，diff 命令会比较两个目录下名字相同的文本文件。列出不同的二进制文件、公共子目录和只在一个目录出现的文件。</p>
<h2 id="3．命令参数："><a href="#3．命令参数：" class="headerlink" title="3．命令参数："></a>3．命令参数：</h2><ul>
<li><ul>
<li>　指定要显示多少行的文本。此参数必须与-c或-u参数一并使用。</li>
</ul>
</li>
<li>-a或–text 　diff预设只会逐行比较文本文件。</li>
<li>-b或–ignore-space-change 　不检查空格字符的不同。</li>
<li>-B或–ignore-blank-lines 　不检查空白行。</li>
<li>-c 　显示全部内文，并标出不同之处。</li>
<li>-C或–context 　与执行”-c-“指令相同。</li>
<li>-d或–minimal 　使用不同的演算法，以较小的单位来做比较。</li>
<li>-D或ifdef 　此参数的输出格式可用于前置处理器巨集。</li>
<li>-e或–ed 　此参数的输出格式可用于ed的script文件。</li>
<li>-f或-forward-ed 　输出的格式类似ed的script文件，但按照原来文件的顺序来显示不同处。</li>
<li>-H或–speed-large-files 　比较大文件时，可加快速度。</li>
<li>-l或–ignore-matching-lines 　若两个文件在某几行有所不同，而这几行同时都包含了选项中指定的字符或字符串，则不显示这两个文件的差异。</li>
<li>-i或–ignore-case 　不检查大小写的不同。</li>
<li>-l或–paginate 　将结果交由pr程序来分页。</li>
<li>-n或–rcs 　将比较结果以RCS的格式来显示。</li>
<li>-N或–new-file 　在比较目录时，若文件A仅出现在某个目录中，预设会显示：Only in目录：文件A若使用-N参数，则diff会将文件A与一个空白的文件比较。</li>
<li>-p 　若比较的文件为C语言的程序码文件时，显示差异所在的函数名称。</li>
<li>-P或–unidirectional-new-file 　与-N类似，但只有当第二个目录包含了一个第一个目录所没有的文件时，才会将这个文件与空白的文件做比较。</li>
<li>-q或–brief 　仅显示有无差异，不显示详细的信息。</li>
<li>-r或–recursive 　比较子目录中的文件。</li>
<li>-s或–report-identical-files 　若没有发现任何差异，仍然显示信息。</li>
<li>-S或–starting-file 　在比较目录时，从指定的文件开始比较。</li>
<li>-t或–expand-tabs 　在输出时，将tab字符展开。</li>
<li>-T或–initial-tab 　在每行前面加上tab字符以便对齐。</li>
<li>-u,-U或–unified= 　以合并的方式来显示文件内容的不同。</li>
<li>-v或–version 　显示版本信息。</li>
<li>-w或–ignore-all-space 　忽略全部的空格字符。</li>
<li>-W或–width 　在使用-y参数时，指定栏宽。</li>
<li>-x或–exclude 　不比较选项中所指定的文件或目录。</li>
<li>-X或–exclude-from 　您可以将文件或目录类型存成文本文件，然后在=中指定此文本文件。</li>
<li>-y或–side-by-side 　以并列的方式显示文件的异同之处。</li>
<li>–help 　显示帮助。</li>
<li>–left-column 　在使用-y参数时，若两个文件某一行内容相同，则仅在左侧的栏位显示该行内容。</li>
<li>–suppress-common-lines 　在使用-y参数时，仅显示不同之处。</li>
</ul>
<h2 id="4．使用实例："><a href="#4．使用实例：" class="headerlink" title="4．使用实例："></a>4．使用实例：</h2><h3 id="实例1：比较两个文件"><a href="#实例1：比较两个文件" class="headerlink" title="实例1：比较两个文件"></a>实例1：比较两个文件</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff log2014.log log2013.log</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[root@localhost test3]<span class="comment"># diff log2014.log log2013.log </span></div><div class="line">3c3</div><div class="line">&lt; 2014-03</div><div class="line">---</div><div class="line">&gt; 2013-03</div><div class="line">8c8</div><div class="line">&lt; 2013-07</div><div class="line">---</div><div class="line">&gt; 2013-08</div><div class="line">11,12d10</div><div class="line">&lt; 2013-11</div><div class="line">&lt; 2013-12</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;上面的“3c3”和“8c8”表示log2014.log和log20143log文件在3行和第8行内容有所不同；”11,12d10”表示第一个文件比第二个文件多了第11和12行。</p>
<h4 id="diff-的normal-显示格式有三种提示"><a href="#diff-的normal-显示格式有三种提示" class="headerlink" title="diff 的normal 显示格式有三种提示:"></a>diff 的normal 显示格式有三种提示:</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;a - add</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;c - change</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;d - delete </p>
<h3 id="实例2：并排格式输出"><a href="#实例2：并排格式输出" class="headerlink" title="实例2：并排格式输出"></a>实例2：并排格式输出</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff log2013.log log2014.log  -y -W 50</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[root@localhost test3]<span class="comment"># diff log2014.log log2013.log  -y -W 50</span></div><div class="line">2013-01                 2013-01</div><div class="line">2013-02                 2013-02</div><div class="line">2014-03               | 2013-03</div><div class="line">2013-04                 2013-04</div><div class="line">2013-05                 2013-05</div><div class="line">2013-06                 2013-06</div><div class="line">2013-07                 2013-07</div><div class="line">2013-07               | 2013-08</div><div class="line">2013-09                 2013-09</div><div class="line">2013-10                 2013-10</div><div class="line">2013-11               &lt;</div><div class="line">2013-12               &lt;</div><div class="line">[root@localhost test3]<span class="comment"># diff log2013.log log2014.log  -y -W 50</span></div><div class="line">2013-01                 2013-01</div><div class="line">2013-02                 2013-02</div><div class="line">2013-03               | 2014-03</div><div class="line">2013-04                 2013-04</div><div class="line">2013-05                 2013-05</div><div class="line">2013-06                 2013-06</div><div class="line">2013-07                 2013-07</div><div class="line">2013-08               | 2013-07</div><div class="line">2013-09                 2013-09</div><div class="line">2013-10                 2013-10</div><div class="line">                      &gt; 2013-11</div><div class="line">                      &gt; 2013-12</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“|”表示前后2个文件内容有不同</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“&lt;”表示后面文件比前面文件少了1行内容</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“&gt;”表示后面文件比前面文件多了1行内容</p>
<h3 id="实例3：上下文输出格式"><a href="#实例3：上下文输出格式" class="headerlink" title="实例3：上下文输出格式"></a>实例3：上下文输出格式</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff log2013.log log2014.log  -c</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">[root@localhost test3]<span class="comment"># diff log2013.log log2014.log  -c</span></div><div class="line">*** log2013.log 2012-12-07 16:36:26.000000000 +0800</div><div class="line">--- log2014.log 2012-12-07 18:01:54.000000000 +0800</div><div class="line">***************</div><div class="line">*** 1,10 ****</div><div class="line">  2013-01</div><div class="line">  2013-02</div><div class="line">! 2013-03</div><div class="line">  2013-04</div><div class="line">  2013-05</div><div class="line">  2013-06</div><div class="line">  2013-07</div><div class="line">! 2013-08</div><div class="line">  2013-09</div><div class="line">  2013-10</div><div class="line">--- 1,12 ----</div><div class="line">  2013-01</div><div class="line">  2013-02</div><div class="line">! 2014-03</div><div class="line">  2013-04</div><div class="line">  2013-05</div><div class="line">  2013-06</div><div class="line">  2013-07</div><div class="line">! 2013-07</div><div class="line">  2013-09</div><div class="line">  2013-10</div><div class="line">+ 2013-11</div><div class="line">+ 2013-12[root@localhost test3]<span class="comment"># diff log2014.log log2013.log  -c</span></div><div class="line">*** log2014.log 2012-12-07 18:01:54.000000000 +0800</div><div class="line">--- log2013.log 2012-12-07 16:36:26.000000000 +0800</div><div class="line">***************</div><div class="line">*** 1,12 ****</div><div class="line">  2013-01</div><div class="line">  2013-02</div><div class="line">! 2014-03</div><div class="line">  2013-04</div><div class="line">  2013-05</div><div class="line">  2013-06</div><div class="line">  2013-07</div><div class="line">! 2013-07</div><div class="line">  2013-09</div><div class="line">  2013-10</div><div class="line">- 2013-11</div><div class="line">- 2013-12</div><div class="line">--- 1,10 ----</div><div class="line">  2013-01</div><div class="line">  2013-02</div><div class="line">! 2013-03</div><div class="line">  2013-04</div><div class="line">  2013-05</div><div class="line">  2013-06</div><div class="line">  2013-07</div><div class="line">! 2013-08</div><div class="line">  2013-09</div><div class="line">  2013-10[root@localhost test3]<span class="comment">#</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;这种方式在开头两行作了比较文件的说明，这里有三中特殊字符：</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“＋” 比较的文件的后者比前着多一行</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“－” 比较的文件的后者比前着少一行</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“！” 比较的文件两者有差别的行</p>
<h3 id="实例4：统一格式输出"><a href="#实例4：统一格式输出" class="headerlink" title="实例4：统一格式输出"></a>实例4：统一格式输出</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff log2014.log log2013.log  -u</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@localhost test3]<span class="comment"># diff log2014.log log2013.log  -u</span></div><div class="line">--- log2014.log 2012-12-07 18:01:54.000000000 +0800</div><div class="line">+++ log2013.log 2012-12-07 16:36:26.000000000 +0800</div><div class="line">@@ -1,12 +1,10 @@</div><div class="line"> 2013-01</div><div class="line"> 2013-02</div><div class="line">-2014-03</div><div class="line">+2013-03</div><div class="line"> 2013-04</div><div class="line"> 2013-05</div><div class="line"> 2013-06</div><div class="line"> 2013-07</div><div class="line">-2013-07</div><div class="line">+2013-08</div><div class="line"> 2013-09</div><div class="line"> 2013-10</div><div class="line">-2013-11</div><div class="line">-2013-12</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;它的第一部分，也是文件的基本信息：</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;— log2014.log 2012-12-07 18:01:54.000000000 +0800</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+++ log2013.log 2012-12-07 16:36:26.000000000 +0800</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;”—“表示变动前的文件，”+++”表示变动后的文件。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;第二部分，变动的位置用两个@作为起首和结束。</p>
<p>@@ -1,12 +1,10 @@</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;前面的”-1,12”分成三个部分：减号表示第一个文件（即log2014.log），”1”表示第1行，”12”表示连续12行。合在一起，就表示下面是第一个文件从第1行开始的连续12行。同样的，”+1,10”表示变动后，成为第二个文件从第1行开始的连续10行。</p>
<h3 id="实例5：比较文件夹不同"><a href="#实例5：比较文件夹不同" class="headerlink" title="实例5：比较文件夹不同"></a>实例5：比较文件夹不同</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff  test3 test6</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># diff test3 test6</span></div><div class="line">Only <span class="keyword">in</span> test6: linklog.log</div><div class="line">Only <span class="keyword">in</span> test6: log2012.log</div><div class="line">diff test3/log2013.log test6/log2013.log</div><div class="line">1,10c1,3</div><div class="line">&lt; 2013-01</div><div class="line">&lt; 2013-02</div><div class="line">&lt; 2013-03</div><div class="line">&lt; 2013-04</div><div class="line">&lt; 2013-05</div><div class="line">&lt; 2013-06</div><div class="line">&lt; 2013-07</div><div class="line">&lt; 2013-08</div><div class="line">&lt; 2013-09</div><div class="line">&lt; 2013-10</div><div class="line">---</div><div class="line">&gt; hostnamebaidu=baidu.com</div><div class="line">&gt; hostnamesina=sina.com</div><div class="line">&gt; hostnames=<span class="literal">true</span></div><div class="line">diff test3/log2014.log test6/log2014.log</div><div class="line">1,12d0</div><div class="line">&lt; 2013-01</div><div class="line">&lt; 2013-02</div><div class="line">&lt; 2014-03</div><div class="line">&lt; 2013-04</div><div class="line">&lt; 2013-05</div><div class="line">&lt; 2013-06</div><div class="line">&lt; 2013-07</div><div class="line">&lt; 2013-07</div><div class="line">&lt; 2013-09</div><div class="line">&lt; 2013-10</div><div class="line">&lt; 2013-11</div><div class="line">&lt; 2013-12</div><div class="line">Only <span class="keyword">in</span> test6: log2015.log</div><div class="line">Only <span class="keyword">in</span> test6: log2016.log</div><div class="line">Only <span class="keyword">in</span> test6: log2017.log</div><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment">#</span></div></pre></td></tr></table></figure>
<h3 id="实例6：比较两个文件不同，并生产补丁"><a href="#实例6：比较两个文件不同，并生产补丁" class="headerlink" title="实例6：比较两个文件不同，并生产补丁"></a>实例6：比较两个文件不同，并生产补丁</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diff -ruN log2013.log log2014.log &gt;patch.log</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[root@localhost test3]<span class="comment"># diff -ruN log2013.log log2014.log &gt;patch.log</span></div><div class="line">[root@localhost test3]<span class="comment"># ll</span></div><div class="line">总计 12</div><div class="line">-rw-r--r-- 2 root root  80 12-07 16:36 log2013.log</div><div class="line">-rw-r--r-- 1 root root  96 12-07 18:01 log2014.log</div><div class="line">-rw-r--r-- 1 root root 248 12-07 21:33 patch.log</div><div class="line">[root@localhost test3]<span class="comment"># cat patc.log</span></div><div class="line">cat: patc.log: 没有那个文件或目录</div><div class="line">[root@localhost test3]<span class="comment"># cat patch.log </span></div><div class="line">--- log2013.log 2012-12-07 16:36:26.000000000 +0800</div><div class="line">+++ log2014.log 2012-12-07 18:01:54.000000000 +0800</div><div class="line">@@ -1,10 +1,12 @@</div><div class="line"> 2013-01</div><div class="line"> 2013-02</div><div class="line">-2013-03</div><div class="line">+2014-03</div><div class="line"> 2013-04</div><div class="line"> 2013-05</div><div class="line"> 2013-06</div><div class="line"> 2013-07</div><div class="line">-2013-08</div><div class="line">+2013-07</div><div class="line"> 2013-09</div><div class="line"> 2013-10</div><div class="line">+2013-11</div><div class="line">+2013-12[root@localhost test3]<span class="comment">#</span></div></pre></td></tr></table></figure>
<h3 id="实例7：打补丁"><a href="#实例7：打补丁" class="headerlink" title="实例7：打补丁"></a>实例7：打补丁</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[root@localhost test3]<span class="comment"># cat log2013.log</span></div><div class="line">2013-01</div><div class="line">2013-02</div><div class="line">2013-03</div><div class="line">2013-04</div><div class="line">2013-05</div><div class="line">2013-06</div><div class="line">2013-07</div><div class="line">2013-08</div><div class="line">2013-09</div><div class="line">2013-10[root@localhost test3]<span class="comment"># patch log2013.log patch.log </span></div><div class="line">patching file log2013.log</div><div class="line">[root@localhost test3]<span class="comment"># </span></div><div class="line">[root@localhost test3]<span class="comment"># cat log2013.log </span></div><div class="line">2013-01</div><div class="line">2013-02</div><div class="line">2014-03</div><div class="line">2013-04</div><div class="line">2013-05</div><div class="line">2013-06</div><div class="line">2013-07</div><div class="line">2013-07</div><div class="line">2013-09</div><div class="line">2013-10</div><div class="line">2013-11</div><div class="line">2013-12[root@localhost test3]<span class="comment">#</span></div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/40. Linux 命令- cal" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/40. Linux 命令- cal/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.259Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/40. Linux 命令- cal/">
        Linux 命令- cal
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cal命令可以用来显示公历（阳历）日历。公历是现在国际通用的历法，又称格列历，通称阳历。“阳历”又名“太阳历”，系以地球绕行太阳一周为一年，为西方各国所通用，故又名“西历”。</p>
<h2 id="1．命令格式"><a href="#1．命令格式" class="headerlink" title="1．命令格式"></a>1．命令格式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cal [参数][月份][年份]</div></pre></td></tr></table></figure>
<h2 id="2．命令功能"><a href="#2．命令功能" class="headerlink" title="2．命令功能"></a>2．命令功能</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;用于查看日历等时间信息，如只有一个参数，则表示年份(1-9999)，如有两个参数，则表示月份和年份</p>
<h2 id="3．命令参数"><a href="#3．命令参数" class="headerlink" title="3．命令参数"></a>3．命令参数</h2><ul>
<li>-1 显示一个月的月历</li>
<li>-3 显示系统前一个月，当前月，下一个月的月历</li>
<li>-s  显示星期天为一个星期的第一天，默认的格式</li>
<li>-m 显示星期一为一个星期的第一天</li>
<li>-j  显示在当年中的第几天（一年日期按天算，从1月1号算起，默认显示当前月在一年中的天数）</li>
<li>-y  显示当前年份的日历</li>
</ul>
<h2 id="4．使用实例"><a href="#4．使用实例" class="headerlink" title="4．使用实例"></a>4．使用实例</h2><h3 id="实例1：显示当前月份日历"><a href="#实例1：显示当前月份日历" class="headerlink" title="实例1：显示当前月份日历"></a>实例1：显示当前月份日历</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cal</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># cal</span></div><div class="line">   十二月 2012     </div><div class="line">日 一 二 三 四 五 六</div><div class="line">                   1</div><div class="line"> 2  3  4  5  6  7  8</div><div class="line"> 9 10 11 12 13 14 15</div><div class="line">16 17 18 19 20 21 22</div><div class="line">23 24 25 26 27 28 29</div><div class="line">30 31</div><div class="line">[root@localhost ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<h3 id="实例2：显示指定月份的日历"><a href="#实例2：显示指定月份的日历" class="headerlink" title="实例2：显示指定月份的日历"></a>实例2：显示指定月份的日历</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cal 9 2012</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># cal 9 2012</span></div><div class="line">     九月 2012      </div><div class="line">日 一 二 三 四 五 六</div><div class="line">                   1</div><div class="line"> 2  3  4  5  6  7  8</div><div class="line"> 9 10 11 12 13 14 15</div><div class="line">16 17 18 19 20 21 22</div><div class="line">23 24 25 26 27 28 29</div><div class="line">30</div></pre></td></tr></table></figure>
<h3 id="实例3：显示2013年日历"><a href="#实例3：显示2013年日历" class="headerlink" title="实例3：显示2013年日历"></a>实例3：显示2013年日历</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cal -y 2013 </div><div class="line">cal 2013</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<p><img src="https://github.com/hcldirgit/image/blob/master/linux%E5%91%BD%E4%BB%A4-cal/01.png?raw=true" alt="iamges"></p>
<h3 id="实例4：显示自1月1日的天数"><a href="#实例4：显示自1月1日的天数" class="headerlink" title="实例4：显示自1月1日的天数"></a>实例4：显示自1月1日的天数</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cal -j</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># cal -j</span></div><div class="line">        十二月 2012        </div><div class="line">  日   一   二   三   四   五   六</div><div class="line">                        336</div><div class="line">337 338 339 340 341 342 343</div><div class="line">344 345 346 347 348 349 350</div><div class="line">351 352 353 354 355 356 357</div><div class="line">358 359 360 361 362 363 364</div><div class="line">365 366[root@localhost ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<h3 id="实例5：星期一显示在第一列"><a href="#实例5：星期一显示在第一列" class="headerlink" title="实例5：星期一显示在第一列"></a>实例5：星期一显示在第一列</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cal -m</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># cal -m</span></div><div class="line">    十二月 2012     </div><div class="line">一 二 三 四 五 六 日</div><div class="line">                1  2</div><div class="line"> 3  4  5  6  7  8  9</div><div class="line">10 11 12 13 14 15 16</div><div class="line">17 18 19 20 21 22 23</div><div class="line">24 25 26 27 28 29 30</div><div class="line">31</div><div class="line">[root@localhost ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/13. Linux命令- less" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/13. Linux命令- less/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.258Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/13. Linux命令- less/">
        Linux 命令- less
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;less 工具也是对文件或其它输出进行分页显示的工具，应该说是linux正统查看文件内容的工具，功能极其强大。less 的用法比起 more 更加的有弹性。在 more 的时候，我们并没有办法向前面翻， 只能往后面看，但若使用了 less 时，就可以使用 [pageup] [pagedown] 等按键的功能来往前往后翻看文件，更容易用来查看一个文件的内容！除此之外，在 less 里头可以拥有更多的搜索功能，不止可以向下搜，也可以向上搜。     </p>
<h2 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">less [参数] [文件]</div></pre></td></tr></table></figure>
<h2 id="命令功能"><a href="#命令功能" class="headerlink" title="命令功能"></a>命令功能</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;less 与 more 类似，但使用 less 可以随意浏览文件，而 more 仅能向前移动，却不能向后移动，而且 less 在查看之前不会加载真个文件。</p>
<h2 id="命令参数"><a href="#命令参数" class="headerlink" title="命令参数"></a>命令参数</h2><ul>
<li>-b &lt;缓冲区大小&gt; 设置缓冲区的大小</li>
<li>-e  当文件显示结束后，自动离开</li>
<li>-f  强迫打开特殊文件，例如外围设备代号、目录和二进制文件</li>
<li>-g  只标志最后搜索的关键词</li>
<li>-i  忽略搜索时的大小写</li>
<li>-m  显示类似more命令的百分比</li>
<li>-N  显示每行的行号</li>
<li>-o &lt;文件名&gt; 将less 输出的内容在指定文件中保存起来</li>
<li>-Q  不使用警告音</li>
<li>-s  显示连续空行为一行</li>
<li>-S  行过长时间将超出部分舍弃</li>
<li>-x &lt;数字&gt; 将“tab”键显示为规定的数字空格</li>
<li>/字符串：向下搜索“字符串”的功能</li>
<li>?字符串：向上搜索“字符串”的功能</li>
<li>n：重复前一个搜索（与 / 或 ? 有关）</li>
<li>N：反向重复前一个搜索（与 / 或 ? 有关）</li>
<li>b  向后翻一页</li>
<li>d  向后翻半页</li>
<li>h  显示帮助界面</li>
<li>Q  退出less 命令</li>
<li>u  向前滚动半页</li>
<li>y  向前滚动一行</li>
<li>空格键 滚动一行</li>
<li>回车键 滚动一页</li>
<li>[pagedown]： 向下翻动一页</li>
<li>[pageup]：   向上翻动一页</li>
</ul>
<h2 id="使用实例"><a href="#使用实例" class="headerlink" title="使用实例"></a>使用实例</h2><h3 id="实例1：查看文件"><a href="#实例1：查看文件" class="headerlink" title="实例1：查看文件"></a>实例1：查看文件</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">less log2013.log</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<p><img src="https://github.com/hcldirgit/image/blob/master/less/01.png?raw=true" alt="image"></p>
<h3 id="实例2：ps-查看进程信息并通过-less-分页显示"><a href="#实例2：ps-查看进程信息并通过-less-分页显示" class="headerlink" title="实例2：ps 查看进程信息并通过 less 分页显示"></a>实例2：ps 查看进程信息并通过 less 分页显示</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps -ef | less</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<p><img src="https://github.com/hcldirgit/image/blob/master/less/02.png?raw=true" alt="image"></p>
<h3 id="实例3：查看命令示例使用记录并通过-less-分页显示"><a href="#实例3：查看命令示例使用记录并通过-less-分页显示" class="headerlink" title="实例3：查看命令示例使用记录并通过 less 分页显示"></a>实例3：查看命令示例使用记录并通过 less 分页显示</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">history</span> | less</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># history | less</span></div><div class="line">22  scp -r tomcat6.0.32 root@192.168.120.203:/opt/soft</div><div class="line">23  <span class="built_in">cd</span> ..</div><div class="line">24  scp -r web root@192.168.120.203:/opt/</div><div class="line">25  <span class="built_in">cd</span> soft</div><div class="line">26  ls</div><div class="line">27  scp -r jdk1.6.0_16/ root@192.168.120.203:/opt/soft</div><div class="line">28  clear</div><div class="line">29  vim /etc/profile</div><div class="line">30  vim /etc/profile</div><div class="line">31  <span class="built_in">cd</span> tomcat6.0.32/bin/</div><div class="line">32  ls</div><div class="line">33  ./shutdown.sh</div><div class="line">34  ./startup.sh</div><div class="line">35  vim startup.sh</div><div class="line">36  ls</div><div class="line">37  <span class="built_in">echo</span> <span class="variable">$JAVA_HOME</span></div><div class="line">38  java</div><div class="line">39  ls</div><div class="line">40  ls</div><div class="line">41  clear</div><div class="line">42  <span class="built_in">cd</span> /opt</div><div class="line">43  ls</div><div class="line">44  cp apache-tomcat-6.0.32.tar.gz soft/</div><div class="line">45  ls</div><div class="line">46  rm -f apache-tomcat-6.0.32.tar.gz </div><div class="line">47  ls</div><div class="line">48  <span class="built_in">cd</span> soft</div><div class="line">49  ls</div><div class="line">50  tar -vzf apache-tomcat-6.0.32.tar.gz </div><div class="line">51  tar -vzfx apache-tomcat-6.0.32.tar.gz </div><div class="line">52  tar -zxvf apache-tomcat-6.0.32.tar.gz </div><div class="line">53  ls</div><div class="line">54  <span class="built_in">cd</span> apache-tomcat-6.0.32</div><div class="line">55  ls</div><div class="line">56  <span class="built_in">cd</span> ..</div><div class="line">57  mv apache-tomcat-6.0.32 tomcat6.0.32</div><div class="line">58  ls</div><div class="line">59  <span class="built_in">cd</span> tomcat6.0.32/</div><div class="line">60  ls</div></pre></td></tr></table></figure>
<h3 id="实例4：浏览多个文件"><a href="#实例4：浏览多个文件" class="headerlink" title="实例4：浏览多个文件"></a>实例4：浏览多个文件</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">less log2013.log log2014.log</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong>   </p>
<p><img src="https://github.com/hcldirgit/image/blob/master/less/03.png?raw=true" alt="image"></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;输出：n 后，切换到 log2014.log</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;输出：p 后，切换到 log2013.log    </p>
<h2 id="附加备注"><a href="#附加备注" class="headerlink" title="附加备注"></a>附加备注</h2><h3 id="1-全屏导航"><a href="#1-全屏导航" class="headerlink" title="1.全屏导航"></a>1.全屏导航</h3><ul>
<li>ctrl + F - 向前移动一屏</li>
<li>ctrl + B - 向后移动一屏</li>
<li>ctrl + D - 向前移动半屏</li>
<li>ctrl + U - 向后移动半屏</li>
</ul>
<h3 id="2-单行导航"><a href="#2-单行导航" class="headerlink" title="2.单行导航"></a>2.单行导航</h3><ul>
<li>j - 向前移动一行</li>
<li>k - 向后移动一行</li>
</ul>
<h3 id="3-其他导航"><a href="#3-其他导航" class="headerlink" title="3.其他导航"></a>3.其他导航</h3><ul>
<li>G - 移动到最后一行</li>
<li>g - 移动到第一行</li>
<li>q / ZZ - 退出 less 命令    </li>
</ul>
<h3 id="4-其他有用的命令"><a href="#4-其他有用的命令" class="headerlink" title="4.其他有用的命令"></a>4.其他有用的命令</h3><ul>
<li>v - 使用配置的编辑器编辑当前文件</li>
<li>h - 显示 less 的帮助文档</li>
<li>&amp;pattern - 仅显示匹配模式的行，而不是整个文件</li>
</ul>
<h3 id="5-标记导航"><a href="#5-标记导航" class="headerlink" title="5.标记导航"></a>5.标记导航</h3><ul>
<li>当使用 less 查看大文件时，可以在任何一个位置作标记，可以通过命令导航到标有特定标记的文档位置：</li>
<li>ma - 使用 a 标记文本的当前位置</li>
<li>‘a - 导航到标记 a 处</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/67. Linux 命令- tee" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/67. Linux 命令- tee/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.257Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/67. Linux 命令- tee/">
        Linux 命令- tee
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tee 命令用于读取标准输入的数据，并将其内容输出成文件。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tee 指令会从标准输入设备读取数据，将其内容输出到标准输出设备，同时保存成文件。</p>
<h2 id="1-命令语法"><a href="#1-命令语法" class="headerlink" title="1. 命令语法"></a>1. 命令语法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tee [参数] [文件]</div></pre></td></tr></table></figure>
<h2 id="2-命令参数"><a href="#2-命令参数" class="headerlink" title="2. 命令参数"></a>2. 命令参数</h2><ul>
<li>-a或–append 　附加到既有文件的后面，而非覆盖它．</li>
<li>-i或–ignore-interrupts 　忽略中断信号。</li>
<li>–help 　在线帮助。</li>
<li>–version 　显示版本信息。</li>
</ul>
<h2 id="使用实例"><a href="#使用实例" class="headerlink" title="使用实例"></a>使用实例</h2><h3 id="实例1：使用指令-tee-将用户输入的数据同时保存到文件-file1-和-file2-中"><a href="#实例1：使用指令-tee-将用户输入的数据同时保存到文件-file1-和-file2-中" class="headerlink" title="实例1：使用指令 tee 将用户输入的数据同时保存到文件 file1 和 file2 中"></a>实例1：使用指令 tee 将用户输入的数据同时保存到文件 file1 和 file2 中</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tee file1 file2</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># tee file1 file2</span></div><div class="line">my linux</div><div class="line">my linux</div><div class="line">^C</div><div class="line">[root@localhost ~]<span class="comment"># cat file1      </span></div><div class="line">my linux</div><div class="line">[root@localhost ~]<span class="comment"># cat file2      </span></div><div class="line">my linux</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;也可以使用管道符执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># echo 'my linux'|tee file1 file2</span></div><div class="line">my linux</div><div class="line">[root@localhost ~]<span class="comment"># cat file1</span></div><div class="line">my linux</div><div class="line">[root@localhost ~]<span class="comment"># cat file2</span></div><div class="line">my linux</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/34. Linux 命令- zip 和 unzip" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/34. Linux 命令- zip 和 unzip/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.256Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/34. Linux 命令- zip 和 unzip/">
        Linux 命令- zip 和 unzip
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="zip-命令"><a href="#zip-命令" class="headerlink" title="zip 命令"></a>zip 命令</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;zip 压缩目录也可以压缩文件，压缩目录时，需要指定目录下的文件</p>
<h3 id="1-命令格式"><a href="#1-命令格式" class="headerlink" title="1.命令格式"></a>1.命令格式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip [参数] [压缩名] [文件或目录]</div></pre></td></tr></table></figure>
<h3 id="2-命令参数"><a href="#2-命令参数" class="headerlink" title="2.命令参数"></a>2.命令参数</h3><ul>
<li>-A 调整可执行的自动解压缩文件。 </li>
<li>-b&lt;工作目录&gt; 指定暂时存放文件的目录。</li>
<li>-c 替每个被压缩的文件加上注释。</li>
<li>-d 从压缩文件内删除指定的文件。</li>
<li>-D 压缩文件内不建立目录名称。</li>
<li>-f 此参数的效果和指定”-u”参数类似，但不仅更新既有文件，如果某些文件原本不存在于压缩文件内，使用本参数会一并将其加入压缩文件中。 </li>
<li>-F 尝试修复已损坏的压缩文件。 </li>
<li>-g 将文件压缩后附加在既有的压缩文件之后，而非另行建立新的压缩文件。 - -h 在线帮助。 </li>
<li>-i&lt;范本样式&gt; 只压缩符合条件的文件。</li>
<li>-j 只保存文件名称及其内容，而不存放任何目录名称。</li>
<li>-J 删除压缩文件前面不必要的数据。</li>
<li>-k 使用MS-DOS兼容格式的文件名称。</li>
<li>-l 压缩文件时，把LF字符置换成LF+CR字符。 </li>
<li>-ll 压缩文件时，把LF+CR字符置换成LF字符。 </li>
<li>-L 显示版权信息。</li>
<li>-m 将文件压缩并加入压缩文件后，删除原始文件，即把文件移到压缩文件中。</li>
<li>-n&lt;字尾字符串&gt; 不压缩具有特定字尾字符串的文件。</li>
<li>-o 以压缩文件内拥有最新更改时间的文件为准，将压缩文件的更改时间设成和该文件相同。 </li>
<li>-q 不显示指令执行过程。 </li>
<li>-r 递归处理，将指定目录下的所有文件和子目录一并处理。</li>
<li>-S 包含系统和隐藏文件。</li>
<li>-t&lt;日期时间&gt; 把压缩文件的日期设成指定的日期。</li>
<li>-T 检查备份文件内的每个文件是否正确无误。 </li>
<li>-u 更换较新的文件到压缩文件内。</li>
<li>-v 显示指令执行过程或显示版本信息。</li>
<li>-V 保存VMS操作系统的文件属性。 </li>
<li>-w 在文件名称里假如版本编号，本参数仅在VMS操作系统下有效。</li>
<li>-x&lt;范本样式&gt; 压缩时排除符合条件的文件。 </li>
<li>-X 不保存额外的文件属性。 </li>
<li>-y 直接保存符号连接，而非该连接所指向的文件，本参数仅在UNIX之类的系统下有效。 </li>
<li>-z 替压缩文件加上注释。</li>
<li>-$ 保存第一个被压缩文件所在磁盘的卷册名称。</li>
<li>-&lt;压缩效率&gt; 压缩效率是一个介于1-9的数值。</li>
</ul>
<h3 id="3-命令功能"><a href="#3-命令功能" class="headerlink" title="3.命令功能"></a>3.命令功能</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;zip 是个使用广泛的压缩程序，文件经它压缩后会另外产生具有 “.zip” 扩展名的压缩文件。</p>
<h3 id="4-使用实例"><a href="#4-使用实例" class="headerlink" title="4.使用实例"></a>4.使用实例</h3><h4 id="实例1：将-test-txt-文件压缩为-test-zip-文件"><a href="#实例1：将-test-txt-文件压缩为-test-zip-文件" class="headerlink" title="实例1：将 test.txt 文件压缩为 test.zip 文件"></a>实例1：将 test.txt 文件压缩为 test.zip 文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip test.zip test.txt</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip test.zip test.txt</span></div><div class="line">adding: test.txt (deflated 35%)</div></pre></td></tr></table></figure>
<h4 id="实例2：压缩率为1，压缩-test-txt-文件"><a href="#实例2：压缩率为1，压缩-test-txt-文件" class="headerlink" title="实例2：压缩率为1，压缩 test.txt 文件"></a>实例2：压缩率为1，压缩 test.txt 文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip -1 test.zip test.txt</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip -1 test.zip test.txt</span></div><div class="line">adding: test.txt(deflated 35%)</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;压缩率为1，最高压缩率，当然也是最慢的压缩方法。但上例压缩率依然为35，因为压缩文件为文本文件，压缩率基本不变。</p>
<h4 id="实例3：递归压缩子目录"><a href="#实例3：递归压缩子目录" class="headerlink" title="实例3：递归压缩子目录"></a>实例3：递归压缩子目录</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip -r test.zip /<span class="built_in">test</span>/</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip -r test.zip /test/</span></div><div class="line">adding: <span class="built_in">test</span>/ (stored 0%)</div><div class="line">adding: <span class="built_in">test</span>/<span class="built_in">test</span>/ (stored 0%)</div><div class="line">adding: <span class="built_in">test</span>/test.txt (deflated 35%)</div></pre></td></tr></table></figure>
<h4 id="实例4：删除已有-zip-文件中文件"><a href="#实例4：删除已有-zip-文件中文件" class="headerlink" title="实例4：删除已有 zip 文件中文件"></a>实例4：删除已有 zip 文件中文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip -d test.zip <span class="built_in">test</span>/test.txt</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip -r test.zip test</span></div><div class="line">adding: <span class="built_in">test</span>/ (stored 0%)</div><div class="line">adding: <span class="built_in">test</span>/<span class="built_in">test</span>/ (stored 0%)</div><div class="line">adding: <span class="built_in">test</span>/test.txt (deflated 35%)</div><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip -d test.zip test/test.txt</span></div><div class="line">deleting: <span class="built_in">test</span>/test.txt</div></pre></td></tr></table></figure>
<h4 id="实例5：向已有-zip-文件增加压缩文件"><a href="#实例5：向已有-zip-文件增加压缩文件" class="headerlink" title="实例5：向已有 zip 文件增加压缩文件"></a>实例5：向已有 zip 文件增加压缩文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip -m test.zip ./<span class="built_in">test</span>/test.txt</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip -m test.zip ./test/test.txt</span></div><div class="line">adding: <span class="built_in">test</span>/test.txt (deflated 35%)</div></pre></td></tr></table></figure>
<h4 id="实例6：排除指定文件不压缩"><a href="#实例6：排除指定文件不压缩" class="headerlink" title="实例6：排除指定文件不压缩"></a>实例6：排除指定文件不压缩</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">zip -r test.zip <span class="built_in">test</span>-x ./<span class="built_in">test</span>/test.txt</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># zip -r test.zip test-x ./test/test.txt</span></div><div class="line">updating: <span class="built_in">test</span>/ (stored 0%)</div><div class="line">updating: <span class="built_in">test</span>/<span class="built_in">test</span>/ (stored 0%)</div><div class="line">updating: <span class="built_in">test</span>/test2.txt (deflated 63%)</div></pre></td></tr></table></figure>
<h2 id="unzip-命令"><a href="#unzip-命令" class="headerlink" title="unzip 命令"></a>unzip 命令</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;unzip 用来解压 zip 压缩的压缩文件</p>
<h3 id="1-命令格式-1"><a href="#1-命令格式-1" class="headerlink" title="1.命令格式"></a>1.命令格式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">unzip [参数] [.zip文件] [目录]</div></pre></td></tr></table></figure>
<h3 id="2-命令参数-1"><a href="#2-命令参数-1" class="headerlink" title="2.命令参数"></a>2.命令参数</h3><ul>
<li><p>-c   将 解压缩的结果显示到屏幕上，并对字符做适当的转换。</p>
</li>
<li><p>-f   更 新现有的文件。</p>
</li>
<li><p>-l   显 示压缩文件内所包含的文件。</p>
</li>
<li><p>-p   与-c参数类似，会将解压缩的结果显示到屏幕上，但不会执行任 何的转换。</p>
</li>
<li><p>-t   检 查压缩文件是否正确。，但不解压。</p>
</li>
<li><p>-u   与-f参数类似，但是除了更新现有的文件外，也会将压缩文件中 的其他文件解压缩到目录中。</p>
</li>
<li><p>-v   执 行是时显示详细的信息。或查看压缩文件目录，但不解压。</p>
</li>
<li><p>-z   仅 显示压缩文件的备注文字。</p>
</li>
<li><p>-a   对 文本文件进行必要的字符转换。</p>
</li>
<li><p>-b   不 要对文本文件进行字符转换。</p>
</li>
<li><p>-C   压 缩文件中的文件名称区分大小写。</p>
</li>
<li><p>-j   不 处理压缩文件中原有的目录路径。</p>
</li>
<li><p>-L   将 压缩文件中的全部文件名改为小写。</p>
</li>
<li><p>-M   将 输出结果送到more程 序处理。</p>
</li>
<li><p>-n   解 压缩时不要覆盖原有的文件。</p>
</li>
<li><p>-o   不 必先询问用户，unzip执 行后覆盖原有文件。</p>
</li>
<li><p>-P&lt;密码&gt;   使 用zip的密码选项。</p>
</li>
<li><p>-q   执 行时不显示任何信息。</p>
</li>
<li><p>-s   将 文件名中的空白字符转换为底线字符。</p>
</li>
<li><p>-V   保 留VMS的文件版本信 息。</p>
</li>
<li><p>-X   解 压缩时同时回存文件原来的UID/GID。</p>
</li>
<li><p>[.zip文件]   指定.zip压缩文件。</p>
</li>
<li><p>[文件]   指定 要处理.zip压缩文 件中的哪些文件。</p>
</li>
<li><p>-d&lt;目录&gt;   指 定文件解压缩后所要存储的目录。</p>
</li>
<li><p>-x&lt;文件&gt;   指 定不要处理.zip压 缩文件中的哪些文件。</p>
</li>
<li><p>-Z   unzip -Z等 于执行zipinfo指 令。</p>
</li>
</ul>
<h3 id="3-命令功能-1"><a href="#3-命令功能-1" class="headerlink" title="3.命令功能"></a>3.命令功能</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;unzip 为 zip 压缩文件的解压缩程序。</p>
<h3 id="4-使用实例-1"><a href="#4-使用实例-1" class="headerlink" title="4.使用实例"></a>4.使用实例</h3><h4 id="实例1：解压缩-test-zip"><a href="#实例1：解压缩-test-zip" class="headerlink" title="实例1：解压缩 test.zip"></a>实例1：解压缩 test.zip</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">unzip test.zip</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># unzip test.zip</span></div><div class="line">Archive: test.zip</div><div class="line">creating: <span class="built_in">test</span>/</div><div class="line">creating: <span class="built_in">test</span>/<span class="built_in">test</span>/</div><div class="line">inflating: <span class="built_in">test</span>/test2.txt</div></pre></td></tr></table></figure>
<h4 id="实例2：查看压缩文件目录及文件信息，并不解压"><a href="#实例2：查看压缩文件目录及文件信息，并不解压" class="headerlink" title="实例2：查看压缩文件目录及文件信息，并不解压"></a>实例2：查看压缩文件目录及文件信息，并不解压</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">unzip -v test.zip</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># unzip -v test.zip</span></div><div class="line">Archive: test.zip</div><div class="line">Length Method Size Cmpr Date Time CRC-32 Name</div><div class="line">-------- ------ ------- ---- --------------- -------- ----</div><div class="line">0 Stored 0 0% 10-08-2015 22:41 00000000 <span class="built_in">test</span>/</div><div class="line">0 Stored 0 0% 10-08-2015 22:24 00000000 <span class="built_in">test</span>/<span class="built_in">test</span>/</div><div class="line">2117 Defl:N 781 63% 10-08-2015 22:41 ef2699cd <span class="built_in">test</span>/test2.txt</div><div class="line">-------- ------- --- -------</div><div class="line">2117 781 63% 3 files</div></pre></td></tr></table></figure>
<h3 id="其他应用"><a href="#其他应用" class="headerlink" title="其他应用"></a>其他应用</h3><h4 id="1-将压缩文件-test-zip-在指定目录-tmp-下解压，如果有相同的文件存在，要求-unzip-命令不覆盖原来的文件"><a href="#1-将压缩文件-test-zip-在指定目录-tmp-下解压，如果有相同的文件存在，要求-unzip-命令不覆盖原来的文件" class="headerlink" title="1.将压缩文件 test.zip 在指定目录 /tmp/ 下解压，如果有相同的文件存在，要求 unzip 命令不覆盖原来的文件"></a>1.将压缩文件 test.zip 在指定目录 /tmp/ 下解压，如果有相同的文件存在，要求 unzip 命令不覆盖原来的文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@mysql <span class="built_in">test</span>]<span class="comment"># unzip -n test.zip -d /tmp</span></div></pre></td></tr></table></figure>
<h4 id="2-将压缩文件-test-zip-在指定目录-tmp-下解压缩，如果有相同文件存在，要求-unzip-命令-覆盖原来的文件"><a href="#2-将压缩文件-test-zip-在指定目录-tmp-下解压缩，如果有相同文件存在，要求-unzip-命令-覆盖原来的文件" class="headerlink" title="2.将压缩文件 test.zip 在指定目录 /tmp/ 下解压缩，如果有相同文件存在，要求 unzip 命令 覆盖原来的文件"></a>2.将压缩文件 test.zip 在指定目录 /tmp/ 下解压缩，如果有相同文件存在，要求 unzip 命令 覆盖原来的文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@mysql <span class="built_in">test</span>]<span class="comment"># unzip -o test.zip -d /tmp</span></div></pre></td></tr></table></figure>
<h4 id="使用-unzip-“-zip”-解压当前目录下的所有-zip-文件"><a href="#使用-unzip-“-zip”-解压当前目录下的所有-zip-文件" class="headerlink" title="使用 unzip “*.zip” 解压当前目录下的所有 zip 文件"></a>使用 unzip “*.zip” 解压当前目录下的所有 zip 文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls *.zip |xargs -nl unzip</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/52. Linux 命令- crontab" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/52. Linux 命令- crontab/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.256Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/52. Linux 命令- crontab/">
        Linux 命令- crontab
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;循环运行的例行性计划任务，linux系统则是由 cron (crond) 这个系统服务来控制的。Linux 系统上面原本就有非常多的计划性工作，因此这个系统服务是默认启动的。另外, 由于使用者自己也可以设置计划任务，所以， Linux 系统也提供了使用者控制计划任务的命令 :crontab 命令。</p>
<h2 id="一、crond简介"><a href="#一、crond简介" class="headerlink" title="一、crond简介"></a>一、crond简介</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;crond是linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程，与windows下的计划任务类似，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Linux下的任务调度分为两类，系统任务调度和用户任务调度。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;系统任务调度：系统周期性所要执行的工作，比如写缓存数据到硬盘、日志清理等。在/etc目录下有一个crontab文件，这个就是系统任务调度的配置文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">/etc/crontab文件包括下面几行：</div><div class="line">[root@localhost ~]<span class="comment"># cat /etc/crontab </span></div><div class="line">SHELL=/bin/bash</div><div class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</div><div class="line">MAILTO=<span class="string">""</span>HOME=/</div><div class="line"><span class="comment"># run-parts</span></div><div class="line">51 * * * * root run-parts /etc/cron.hourly</div><div class="line">24 7 * * * root run-parts /etc/cron.daily</div><div class="line">22 4 * * 0 root run-parts /etc/cron.weekly</div><div class="line">42 4 1 * * root run-parts /etc/cron.monthly</div><div class="line">[root@localhost ~]<span class="comment">#</span></div><div class="line">`</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;前四行是用来配置crond任务运行的环境变量，第一行SHELL变量指定了系统要使用哪个shell，这里是bash，第二行PATH变量指定了系统执行命令的路径，第三行MAILTO变量指定了crond的任务执行信息将通过电子邮件发送给root用户，如果MAILTO变量的值为空，则表示不发送任务执行信息给用户，第四行的HOME变量指定了在执行命令或者脚本时使用的主目录。第六至九行表示的含义将在下个小节详细讲述。这里不在多说。<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;用户任务调度：用户定期要执行的工作，比如用户数据备份、定时邮件提醒等。用户可以使用 crontab 工具来定制自己的计划任务。所有用户定义的crontab 文件都被保存在 /var/spool/cron目录中。其文件名与用户名一致。</p>
<h3 id="使用者权限文件："><a href="#使用者权限文件：" class="headerlink" title="使用者权限文件："></a>使用者权限文件：</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;文件：/etc/cron.deny</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;说明：该文件中所列用户不允许使用crontab命令</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;文件：/etc/cron.allow</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;说明：该文件中所列用户允许使用crontab命令</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;文件：/var/spool/cron/</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;说明：所有用户crontab文件存放的目录,以用户名命名</p>
<h3 id="crontab文件的含义："><a href="#crontab文件的含义：" class="headerlink" title="crontab文件的含义："></a>crontab文件的含义：</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">minute   hour   day   month   week   <span class="built_in">command</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;其中：</p>
<ul>
<li>minute： 表示分钟，可以是从0到59之间的任何整数。</li>
<li>hour：表示小时，可以是从0到23之间的任何整数。</li>
<li>day：表示日期，可以是从1到31之间的任何整数。</li>
<li>month：表示月份，可以是从1到12之间的任何整数。</li>
<li>week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。</li>
<li>command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。</li>
</ul>
<p><img src="https://github.com/hcldirgit/image/blob/master/linux%E5%91%BD%E4%BB%A4-crontab/01.png?raw=true" alt=""></p>
<h3 id="在以上各个字段中，还可以使用以下特殊字符："><a href="#在以上各个字段中，还可以使用以下特殊字符：" class="headerlink" title="在以上各个字段中，还可以使用以下特殊字符："></a>在以上各个字段中，还可以使用以下特殊字符：</h3><ul>
<li>星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。</li>
<li>逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”</li>
<li>中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”</li>
<li>正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。</li>
</ul>
<h2 id="二、crond服务"><a href="#二、crond服务" class="headerlink" title="二、crond服务"></a>二、crond服务</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;安装crontab：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install crontabs</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;服务操作说明：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">/sbin/service crond start //启动服务</div><div class="line">/sbin/service crond stop //关闭服务</div><div class="line">/sbin/service crond restart //重启服务</div><div class="line">/sbin/service crond reload //重新载入配置</div><div class="line">查看crontab服务状态：</div><div class="line">service crond status</div><div class="line">手动启动crontab服务：</div><div class="line">service crond start</div><div class="line">查看crontab服务是否已设置为开机启动，执行命令：</div><div class="line">ntsysv</div><div class="line">加入开机自动启动：</div><div class="line">chkconfig –level 35 crond on</div></pre></td></tr></table></figure>
<h2 id="三、crontab命令详解"><a href="#三、crontab命令详解" class="headerlink" title="三、crontab命令详解"></a>三、crontab命令详解</h2><h3 id="1．命令格式"><a href="#1．命令格式" class="headerlink" title="1．命令格式"></a>1．命令格式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">crontab [-u user] file</div><div class="line">crontab [-u user] [ -e | -l | -r ]</div></pre></td></tr></table></figure>
<h3 id="2．命令功能"><a href="#2．命令功能" class="headerlink" title="2．命令功能"></a>2．命令功能</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;通过crontab 命令，我们可以在固定的间隔时间执行指定的系统指令或 shell script脚本。时间间隔的单位可以是分钟、小时、日、月、周及以上的任意组合。这个命令非常设合周期性的日志分析或数据备份等工作。</p>
<h3 id="3．命令参数"><a href="#3．命令参数" class="headerlink" title="3．命令参数"></a>3．命令参数</h3><ul>
<li>-u user：用来设定某个用户的crontab服务，例如，“-u ixdba”表示设定ixdba用户的crontab服务，此参数一般有root用户来运行。</li>
<li>file：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab。如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab。</li>
<li>-e：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。</li>
<li>-l：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。</li>
<li>-r：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。</li>
<li>-i：在删除用户的crontab文件时给确认提示。</li>
</ul>
<h3 id="4．常用方法"><a href="#4．常用方法" class="headerlink" title="4．常用方法"></a>4．常用方法</h3><h4 id="1-创建一个新的crontab文件"><a href="#1-创建一个新的crontab文件" class="headerlink" title="1). 创建一个新的crontab文件"></a>1). 创建一个新的crontab文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;在考虑向cron进程提交一个crontab文件之前，首先要做的一件事情就是设置环境变量EDITOR。cron进程根据它来确定使用哪个编辑器编辑crontab文件。9 9 %的UNIX和LINUX用户都使用vi，如果你也是这样，那么你就编辑$ HOME目录下的. profile文件，在其中加入这样一行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">EDITOR=vi; <span class="built_in">export</span> EDITOR</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;然后保存并退出。不妨创建一个名为<user> cron的文件，其中<user>是用户名，例如， davecron。在该文件中加入如下的内容。</user></user></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># (put your own initials here)echo the date to the console every</span></div><div class="line"><span class="comment"># 15minutes between 6pm and 6am</span></div><div class="line">0,15,30,45 18-06 * * * /bin/<span class="built_in">echo</span> <span class="string">'date'</span> &gt; /dev/console</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;保存并退出。确信前面5个域用空格分隔。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;在上面的例子中，系统将每隔1 5分钟向控制台输出一次当前时间。如果系统崩溃或挂起，从最后所显示的时间就可以一眼看出系统是什么时间停止工作的。在有些系统中，用tty1来表示控制台，可以根据实际情况对上面的例子进行相应的修改。为了提交你刚刚创建的crontab文件，可以把这个新创建的文件作为cron命令的参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ crontab davecron</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;现在该文件已经提交给cron进程，它将每隔1 5分钟运行一次。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;同时，新创建文件的一个副本已经被放在/var/spool/cron目录中，文件名就是用户名(即dave)。</p>
<h4 id="2-列出crontab文件"><a href="#2-列出crontab文件" class="headerlink" title="2). 列出crontab文件"></a>2). 列出crontab文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;为了列出crontab文件，可以用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ crontab -l</div><div class="line">0,15,30,45,18-06 * * * /bin/<span class="built_in">echo</span> `date` &gt; dev/tty1</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;将会看到和上面类似的内容。可以使用这种方法在$ H O M E目录中对crontab文件做一备份：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ crontab -l &gt; <span class="variable">$HOME</span>/mycron</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;这样，一旦不小心误删了crontab文件，可以用上一节所讲述的方法迅速恢复。</p>
<h4 id="3-编辑crontab文件"><a href="#3-编辑crontab文件" class="headerlink" title="3). 编辑crontab文件"></a>3). 编辑crontab文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;如果希望添加、删除或编辑crontab文件中的条目，而E D I TO R环境变量又设置为v i，那么就可以用v i来编辑crontab文件，相应的命令为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ crontab -e</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;可以像使用vi编辑其他任何文件那样修改crontab文件并退出。如果修改了某些条目或添加了新的条目，那么在保存该文件时， c r o n会对其进行必要的完整性检查。如果其中的某个域出现了超出允许范围的值，它会提示你。<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;我们在编辑crontab文件时，没准会加入新的条目。例如，加入下面的一条：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># DT:delete core files,at 3.30am on 1,7,14,21,26,26 days of each month</span></div><div class="line">30 3 1,7,14,21,26 * * /bin/find -name <span class="string">"core' -exec rm &#123;&#125; \;</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;现在保存并退出。最好在crontab文件的每一个条目之上加入一条注释，这样就可以知道它的功能、运行时间，更为重要的是，知道这是哪位用户的作业。<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;现在让我们使用前面讲过的crontab -l命令列出它的全部信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ crontab -l </div><div class="line"><span class="comment"># (crondave installed on Tue May 4 13:07:43 1999)</span></div><div class="line"><span class="comment"># DT:ech the date to the console every 30 minites</span></div><div class="line">0,15,30,45 18-06 * * * /bin/<span class="built_in">echo</span> `date` &gt; /dev/tty1</div><div class="line"><span class="comment"># DT:delete core files,at 3.30am on 1,7,14,21,26,26 days of each month</span></div><div class="line">30 3 1,7,14,21,26 * * /bin/find -name <span class="string">"core' -exec rm &#123;&#125; \;</span></div></pre></td></tr></table></figure>
<h4 id="4-删除crontab文件"><a href="#4-删除crontab文件" class="headerlink" title="4). 删除crontab文件"></a>4). 删除crontab文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;要删除crontab文件，可以用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ crontab -r</div></pre></td></tr></table></figure>
<h4 id="5-恢复丢失的crontab文件"><a href="#5-恢复丢失的crontab文件" class="headerlink" title="5). 恢复丢失的crontab文件"></a>5). 恢复丢失的crontab文件</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;如果不小心误删了crontab文件，假设你在自己的$ H O M E目录下还有一个备份，那么可以将其拷贝到/var/spool/cron/<username>，其中<username>是用户名。如果由于权限问题无法完成拷贝，可以用：</username></username></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ crontab &lt;filename&gt;</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;其中，<filename>是你在$ H O M E目录中副本的文件名。<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;建议在自己的$ H O M E目录中保存一个该文件的副本。我就有过类似的经历，有数次误删了crontab文件（因为r键紧挨在e键的右边）。这就是为什么有些系统文档建议不要直接编辑crontab文件，而是编辑该文件的一个副本，然后重新提交新的文件。<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;有些crontab的变体有些怪异，所以在使用crontab命令时要格外小心。如果遗漏了任何选项，crontab可能会打开一个空文件，或者看起来像是个空文件。这时敲delete键退出，不要按<ctrl-d>，否则你将丢失crontab文件。</ctrl-d></filename></p>
<h3 id="5．使用实例"><a href="#5．使用实例" class="headerlink" title="5．使用实例"></a>5．使用实例</h3><h4 id="实例1：每1分钟执行一次command"><a href="#实例1：每1分钟执行一次command" class="headerlink" title="实例1：每1分钟执行一次command"></a>实例1：每1分钟执行一次command</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">* * * * * <span class="built_in">command</span></div></pre></td></tr></table></figure>
<h4 id="实例2：每小时的第3和第15分钟执行"><a href="#实例2：每小时的第3和第15分钟执行" class="headerlink" title="实例2：每小时的第3和第15分钟执行"></a>实例2：每小时的第3和第15分钟执行</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">3,15 * * * * <span class="built_in">command</span></div></pre></td></tr></table></figure>
<h4 id="实例3：在上午8点到11点的第3和第15分钟执行"><a href="#实例3：在上午8点到11点的第3和第15分钟执行" class="headerlink" title="实例3：在上午8点到11点的第3和第15分钟执行"></a>实例3：在上午8点到11点的第3和第15分钟执行</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">3,15 8-11 * * * <span class="built_in">command</span></div></pre></td></tr></table></figure>
<h4 id="实例4：每隔两天的上午8点到11点的第3和第15分钟执行"><a href="#实例4：每隔两天的上午8点到11点的第3和第15分钟执行" class="headerlink" title="实例4：每隔两天的上午8点到11点的第3和第15分钟执行"></a>实例4：每隔两天的上午8点到11点的第3和第15分钟执行</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">3,15 8-11 */2 * * <span class="built_in">command</span></div><div class="line">``` </div><div class="line"></div><div class="line"><span class="comment">#### 实例5：每个星期一的上午8点到11点的第3和第15分钟执行</span></div><div class="line">&amp;<span class="comment">#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;**命令**</span></div><div class="line"></div><div class="line">```bash</div><div class="line">3,15 8-11 * * 1 <span class="built_in">command</span></div><div class="line">``` </div><div class="line"></div><div class="line"><span class="comment">#### 实例6：每晚的21:30重启smb </span></div><div class="line">&amp;<span class="comment">#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;**命令**</span></div><div class="line"></div><div class="line">```bash</div><div class="line">30 21 * * * /etc/init.d/smb restart</div><div class="line">``` </div><div class="line"></div><div class="line"><span class="comment">#### 实例7：每月1、10、22日的4 : 45重启smb </span></div><div class="line">&amp;<span class="comment">#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;**命令**</span></div><div class="line"></div><div class="line">```bash</div><div class="line">45 4 1,10,22 * * /etc/init.d/smb restart</div></pre></td></tr></table></figure>
<h4 id="实例8：每周六、周日的1-10重启smb"><a href="#实例8：每周六、周日的1-10重启smb" class="headerlink" title="实例8：每周六、周日的1 : 10重启smb"></a>实例8：每周六、周日的1 : 10重启smb</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">10 1 * * 6,0 /etc/init.d/smb restart</div></pre></td></tr></table></figure>
<h4 id="实例9：每天18-00至23-00之间每隔30分钟重启smb"><a href="#实例9：每天18-00至23-00之间每隔30分钟重启smb" class="headerlink" title="实例9：每天18 : 00至23 : 00之间每隔30分钟重启smb"></a>实例9：每天18 : 00至23 : 00之间每隔30分钟重启smb</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">0,30 18-23 * * * /etc/init.d/smb restart</div><div class="line">``` </div><div class="line"></div><div class="line"><span class="comment">#### 实例10：每星期六的晚上11 : 00 pm重启smb </span></div><div class="line">&amp;<span class="comment">#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;**命令**</span></div><div class="line"></div><div class="line">```bash</div><div class="line">0 23 * * 6 /etc/init.d/smb restart</div></pre></td></tr></table></figure>
<h4 id="实例11：每一小时重启smb"><a href="#实例11：每一小时重启smb" class="headerlink" title="实例11：每一小时重启smb"></a>实例11：每一小时重启smb</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">* */1 * * * /etc/init.d/smb restart</div></pre></td></tr></table></figure>
<h4 id="实例12：晚上11点到早上7点之间，每隔一小时重启smb"><a href="#实例12：晚上11点到早上7点之间，每隔一小时重启smb" class="headerlink" title="实例12：晚上11点到早上7点之间，每隔一小时重启smb"></a>实例12：晚上11点到早上7点之间，每隔一小时重启smb</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">* 23-7/1 * * * /etc/init.d/smb restart</div><div class="line">``` </div><div class="line"></div><div class="line"><span class="comment">#### 实例13：每月的4号与每周一到周三的11点重启smb </span></div><div class="line">&amp;<span class="comment">#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;**命令**</span></div><div class="line"></div><div class="line">```bash</div><div class="line">0 11 4 * mon-wed /etc/init.d/smb restart</div></pre></td></tr></table></figure>
<h4 id="实例14：一月一号的4点重启smb"><a href="#实例14：一月一号的4点重启smb" class="headerlink" title="实例14：一月一号的4点重启smb"></a>实例14：一月一号的4点重启smb</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 4 1 jan * /etc/init.d/smb restart</div></pre></td></tr></table></figure>
<h4 id="实例15：每小时执行-etc-cron-hourly目录内的脚本"><a href="#实例15：每小时执行-etc-cron-hourly目录内的脚本" class="headerlink" title="实例15：每小时执行/etc/cron.hourly目录内的脚本"></a>实例15：每小时执行/etc/cron.hourly目录内的脚本</h4><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">01   *   *   *   *     root run-parts /etc/cron.hourly</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;run-parts这个参数了，如果去掉这个参数的话，后面就可以写要运行的某个脚本名，而不是目录名了</p>
<h2 id="四、使用注意事项"><a href="#四、使用注意事项" class="headerlink" title="四、使用注意事项"></a>四、使用注意事项</h2><h3 id="1-注意环境变量问题"><a href="#1-注意环境变量问题" class="headerlink" title="1. 注意环境变量问题"></a>1. 注意环境变量问题</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;有时创建了一个crontab，但是这个任务却无法自动执行，而手动执行这个任务却没有问题，这种情况一般是由于在crontab文件中没有配置环境变量引起的。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;在crontab文件中定义多个调度任务时，需要特别注意的一个问题就是环境变量的设置，因为我们手动执行某个任务时，是在当前shell环境下进行的，程序当然能找到环境变量，而系统自动执行任务调度时，是不会加载任何环境变量的，因此，就需要在crontab文件中指定任务运行所需的所有环境变量，这样，系统执行任务调度时就没有问题了。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;不要假定cron知道所需要的特殊环境，它其实并不知道。所以你要保证在shelll脚本中提供所有必要的路径和环境变量，除了一些自动设置的全局变量。所以注意如下3点：</p>
<ol>
<li><p>脚本中涉及文件路径时写全局路径；</p>
</li>
<li><p>脚本执行要用到java或其他环境变量时，通过source命令引入环境变量，如：</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cat start_cbp.sh</div><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"><span class="built_in">source</span> /etc/profile</div><div class="line"><span class="built_in">export</span> RUN_CONF=/home/d139/conf/platform/cbp/cbp_jboss.conf</div><div class="line">/usr/<span class="built_in">local</span>/jboss-4.0.5/bin/run.sh -c mev &amp;</div></pre></td></tr></table></figure>
<ol>
<li>当手动执行脚本OK，但是crontab死活不执行时。这时必须大胆怀疑是环境变量惹的祸，并可以尝试在crontab中直接引入环境变量解决问题。如：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 * * * * . /etc/profile;/bin/sh /var/www/java/audit_no_count/bin/restart_audit.sh</div></pre></td></tr></table></figure>
<h3 id="2-注意清理系统用户的邮件日志"><a href="#2-注意清理系统用户的邮件日志" class="headerlink" title="2. 注意清理系统用户的邮件日志"></a>2. 注意清理系统用户的邮件日志</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;每条任务调度执行完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行，因此，将每条任务进行重定向处理非常重要。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;例如，可以在crontab文件中设置如下形式，忽略日志输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 */3 * * * /usr/<span class="built_in">local</span>/apache2/apachectl restart &gt;/dev/null 2&gt;&amp;1</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;“/dev/null 2&gt;&amp;1”表示先将标准输出重定向到/dev/null，然后将标准错误重定向到标准输出，由于标准输出已经重定向到了/dev/null，因此标准错误也会重定向到/dev/null，这样日志输出问题就解决了。</p>
<h3 id="3-系统级任务调度与用户级任务调度"><a href="#3-系统级任务调度与用户级任务调度" class="headerlink" title="3. 系统级任务调度与用户级任务调度"></a>3. 系统级任务调度与用户级任务调度</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;系统级任务调度主要完成系统的一些维护操作，用户级任务调度主要完成用户自定义的一些任务，可以将用户级任务调度放到系统级任务调度来完成（不建议这么做），但是反过来却不行，root用户的任务调度操作可以通过“crontab –uroot –e”来设置，也可以将调度任务直接写入/etc/crontab文件，需要注意的是，如果要定义一个定时重启系统的任务，就必须将任务放到/etc/crontab文件，即使在root用户下创建一个定时重启系统的任务也是无效的。</p>
<h3 id="4-其他注意事项"><a href="#4-其他注意事项" class="headerlink" title="4. 其他注意事项"></a>4. 其他注意事项</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;新创建的cron job，不会马上执行，至少要过2分钟才执行。如果重启cron则马上执行。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;当crontab突然失效时，可以尝试/etc/init.d/crond restart解决问题。或者查看日志看某个job有没有执行/报错tail -f /var/log/cron。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;千万别乱运行crontab -r。它从Crontab目录（/var/spool/cron）中删除用户的Crontab文件。删除了该用户的所有crontab都没了。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;在crontab中%是有特殊含义的，表示换行的意思。如果要用的话必须进行转义\%，如经常用的date ‘+%Y%m%d’在crontab里是不会执行的，应该换成date ‘+\%Y\%m\%d’。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-2. Linux 命令/81. iptables详解" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/03/2. Linux 命令/81. iptables详解/" class="article-date">
  	<time datetime="2017-09-02T17:57:34.255Z" itemprop="datePublished">2017-09-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/2. Linux 命令/81. iptables详解/">
        iptables详解
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="iptables简介"><a href="#iptables简介" class="headerlink" title="iptables简介"></a>iptables简介</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;netfilter/iptables（简称为iptables）组成Linux平台下的包过滤防火墙，与大多数的Linux软件一样，这个包过滤防火墙是免费的，它可以代替昂贵的商业防火墙解决方案，完成封包过滤、封包重定向和网络地址转换（NAT）等功能。</p>
<h2 id="iptables基础"><a href="#iptables基础" class="headerlink" title="iptables基础"></a>iptables基础</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;规则（rules）其实就是网络管理员预定义的条件，规则一般的定义为“如果数据包头符合这样的条件，就这样处理这个数据包”。规则存储在内核空间的信息 包过滤表中，这些规则分别指定了源地址、目的地址、传输协议（如TCP、UDP、ICMP）和服务类型（如HTTP、FTP和SMTP）等。当数据包与规 则匹配时，iptables就根据规则所定义的方法来处理这些数据包，如放行（accept）、拒绝（reject）和丢弃（drop）等。配置防火墙的 主要工作就是添加、修改和删除这些规则。</p>
<h2 id="iptables和netfilter的关系"><a href="#iptables和netfilter的关系" class="headerlink" title="iptables和netfilter的关系"></a>iptables和netfilter的关系</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;iptables和netfilter的关系是一个很容易让人搞不清的问题，很多知道iptables却不知道netfilter。其实iptables只是Linux防火墙的管理工具而已，位于/sbin/iptbles。真正实现防火墙功能的是netfilter，它是Linux内核中实现包过滤的内部结构。iptables只是netfilter的一个实现工具。</p>
<h2 id="iptables语法格式"><a href="#iptables语法格式" class="headerlink" title="iptables语法格式"></a>iptables语法格式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables [-t 表名] [命令选项] [链名] [条件匹配] [-j 目标动作或跳转]</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;说明：表名、链名、用户指定iptables命令所操作的表和链，命令选项用于指定管理iptables规则的方式（比如：插入、增加、删除、查看等）；条件匹配用户指定对符合什么样条件的数据包进行处理；目标动作或跳转用于指定数据包的处理方式（比如允许通过、拒绝、丢弃、跳转（jump）给其它链处理）。</p>
<h2 id="iptables控制选项"><a href="#iptables控制选项" class="headerlink" title="iptables控制选项"></a>iptables控制选项</h2><h3 id="基本参数"><a href="#基本参数" class="headerlink" title="基本参数"></a>基本参数</h3><ul>
<li>-A 在指定链的末尾添加（append）一条新的规则</li>
<li>-D 删除（delete）指定链中的某一条规则，可以按规则序号和内容删除</li>
<li>-I 在指定链中插入（insert）一条新的规则，默认在第一行添加</li>
<li>-R 修改、替换（replace）指定链中的某一条规则，可以按规则序号和内容替换</li>
<li>-L 列出（list）指定链中所有的规则进行查看</li>
<li>-E 重命名用户定义的链，不改变链本身</li>
<li>-F 清空（flush）</li>
<li>-N 新建（new-chain）一条用户自己定义的规则链</li>
<li>-X 删除指定表中用户自定义的规则链（delete-chain）</li>
<li>-P 设置指定链的默认策略（policy）</li>
<li>-Z 将所有表的所有链的字节和数据包计数器清零</li>
<li>-n 使用数字形式（numeric）显示输出结果</li>
<li>-v 查看规则表详细信息（verbose）的信息</li>
<li>-V 查看版本(version)</li>
<li>-h 获取帮助（help）</li>
</ul>
<h3 id="描述规则基本参数"><a href="#描述规则基本参数" class="headerlink" title="描述规则基本参数"></a>描述规则基本参数</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;这些规则参数用于描述的协议、源地址、目的地址、允许经过的网络接口，以及如何处理这些数据包。这些描述是对规则的基本描述。</p>
<ul>
<li><p>-p （protocol）指定协议，可以是tcp、udp、或者icmp，可以使用 <strong>all</strong> 来指定所有协议；<br>如果不指定 <strong>-p</strong> 参数，则默认是 <strong>all</strong> 值，这并不明智，请总是明确指定协议名称。<br>可以使用协议名（如tcp），或者是协议值（比如6代表tcp）来指定协议，映射关系查看 <code>/etc/protocols</code> ；<br>还可以使用 <strong>-protocol</strong> 参数代替 <strong>-p</strong> 参数</p>
</li>
<li><p>-s 源地址（source）<br>指定数据包的源地址；<br>参数可以使用IP地址、网络地址、主机名<br>-s 192.168.1.101 指定IP地址，<br>-s 192.168.1.10/24指定网络地址<br>不指定-s参数，就代表所有地址<br>还可以使用 <strong>-src</strong> 或者 <strong>-source</strong></p>
</li>
<li><p>-d 目的地址（destination）<br>指定目的地址<br>参数和-s相同<br>还可以使用 <strong>-dst</strong> 或者 <strong>destination</strong></p>
</li>
<li><p>-j 执行目标（jump to target）<br>指定了当与规则（RUle）匹配时如何处理数据包<br>可能的值是ACCEPT允许、DROP丢掉、REJECT拒绝、QUEUE队列、RETURN返回、MASQUERADE伪装（地址伪装，算是snat中的一种特例，可以实现自动化的snat）<br>还可以指定其他连接（Chain）作为目标</p>
</li>
<li><p>-i 输入接口（input initerface）<br>指定要处理来自哪个接口的数据包（一般指定网卡）<br>这些数据包即将进入 INPUT、FORWARD、PREROUTE链<br>例如：-i etho 指定了要处理经由eth0进入的数据包<br>不指定-i参数，那么将处理进入所有接口的数据包<br>如果出现<code>! -i eth0</code>，那么将处理所有经由eth0意外的接口进入的数据包。<br>出现<code>-i eth+</code>，那么将处理所有经由eth开都的接口进入的数据包<br>还可以使用-in-interface参数</p>
</li>
<li>-o 输出（out interface）<br>指定数据包由哪个接口输出<br>这些数据包即将进入FORWARD、OUTPUT、PORTROUTING链<br>不指定 <strong>-o</strong> 选项，那么系统哈斯那个的所有接口都可以作为输出接口<br>出现 <code>! -o eth0</code> 那么将从 <strong>eth0以外的接口</strong> 输出<br>出现 <code>! eth+</code> ，那么将仅从 <strong>eth开头的接口</strong> 输出<br>还可以使用 <strong>-out-initerface</strong> 参数</li>
</ul>
<h3 id="描述规则扩展参数"><a href="#描述规则扩展参数" class="headerlink" title="描述规则扩展参数"></a>描述规则扩展参数</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;对规则有了基本描述以后，有时候还希望指定端口、TCP标志、ICMP类型等内容。</p>
<ul>
<li>–sport 源端口（source port） 针对 -p tcp 或者 -p udp<br>缺省情况下，将匹配所有端口<br>可以指定端口号或者端口名称，（例如，-sport 22 与 -sport ssh）<br><strong>/etc/services</strong> 文件描述了上述映射关系<br>从性能上讲，使用端口号更好<br>使用冒号可以匹配端口范围，如“-sport 22:100”<br>还可以使用 <strong>-source-port</strong> </li>
<li><p>–dport 目的端口（destination port） 针对 -p tcp 或者 -p udp<br>参数和-sport类似<br>还可以使用 <strong>-destination-port</strong></p>
</li>
<li><p>–tcp-flage TCP标志 针对 -p tcp<br>可以指定由逗号分割的多个参数<br>有效值可以是：SYN、ACK、FIN、RST、URG、PSH<br>可以使用 <strong>ALL</strong> 或者 <strong>NONE</strong></p>
</li>
<li>–icmp-type ICMP类型 针对 -p icmp<br>–icmp-type 0 表示Echo Reply<br>–icmp-type 8 表示Echo</li>
</ul>
<h2 id="iptables处理数据包的四种方式"><a href="#iptables处理数据包的四种方式" class="headerlink" title="iptables处理数据包的四种方式"></a>iptables处理数据包的四种方式</h2><ul>
<li>ACCEPT 允许数据包通过</li>
<li>DROP 直接丢弃数据包，不给任何回应信息</li>
<li>REJECT 拒绝数据包通过，必要时会给数据发送端一个响应的信息。</li>
<li>LOG在/var/log/messages文件中记录日志信息，然后将数据包传递给下一条规则</li>
</ul>
<h2 id="iptables传输数据包的过程"><a href="#iptables传输数据包的过程" class="headerlink" title="iptables传输数据包的过程"></a>iptables传输数据包的过程</h2><ol>
<li>当一个数据包进入网卡时，它首先进入PREROUTING链，内核根据数据包目的IP判断是否需要转送出去。 </li>
<li>如果数据包就是进入本机的，它就会沿着图向下移动，到达INPUT链。数据包到了INPUT链后，任何进程都会收到它。本机上运行的程序可以发送数据包，这些数据包会经过OUTPUT链，然后到达POSTROUTING链输出。 </li>
<li>如果数据包是要转发出去的，且内核允许转发，数据包就会如图所示向右移动，经过FORWARD链，然后到达POSTROUTING链输出。</li>
</ol>
<p><img src="https://github.com/hcldirgit/image/blob/master/iptables%E8%AF%A6%E8%A7%A3/01.png?raw=true" alt=""></p>
<h2 id="iptables的规则表和链"><a href="#iptables的规则表和链" class="headerlink" title="iptables的规则表和链"></a>iptables的规则表和链</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;表（tables）提供的特定的功能，iptables内置了4个表，即filter表、nat表、mangle表、和raw表，分别用于实现包过滤，网络地址转换、包重构（修改）和数据跟踪处理。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;链（chains）是数据包传播的路径，每一条链其实就是众多规则中的一个检查清单，每一条链中可以有一条或数条规则。当一个数据包到达一个链时，iptables就会从链中第一条规则开始检查，看该数据包是否满足规则所定义的条件。如果满足，系统就会根据该条规则所定义的方法处理该数据包；否则iptables将继续检查下一条规则，如果该数据包不符号链中任一条规则，iptables就会根据该链预先定义的默认策略来处理数据包。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;iptables采用“表”和“链”的分层结构。在REHL4中是三张表五个链。现在REHL5成了四张表五个链了，不过多出来的哪个表用的也不太多，所以基本还是和以前一样。下面是四张表五个链。需要明白这些表和链的关系及作用。</p>
<p><img src="https://github.com/hcldirgit/image/blob/master/iptables%E8%AF%A6%E8%A7%A3/02.png?raw=true" alt=""></p>
<h2 id="规则表"><a href="#规则表" class="headerlink" title="规则表"></a>规则表</h2><ol>
<li><p>filter表——三个链：INPUT、FORWARD、OUTPUT<br>作用：过滤数据包，内核模块：iptables=_filter</p>
</li>
<li><p>Nat表——三个链：PREROUTING、POSTROUTING、OUTPUT<br>作用：用于网络地址转换（IP、端口），内核模块：iptable_nat</p>
</li>
<li><p>Mangle表——五个链：PREROUTING、POSTROUTING、INPUT、OUTPUT、FORWARD<br>作用：修改数据包的服务类型、TTL，并且可以配置路由实现QOS，内核模块：iptable_mangle（设置策略时几乎不会用到它）</p>
</li>
<li><p>Raw表——两个链：OUTPUT、PREROUTING<br>作用：决定数据包是否被状态跟踪机制处理，内核模块：iptable_raw（用得不多）</p>
</li>
</ol>
<h2 id="规则链"><a href="#规则链" class="headerlink" title="规则链"></a>规则链</h2><ol>
<li>INPUT——进来的数据包应用此规则链中的策略</li>
<li>OUTPUT——外出的数据包应用此规则链中的策略</li>
<li>ROEWARD——转发数据包时应用此规则链中的策略</li>
<li>PREROUTING——对数据包做路由选择前应用此链中的规则（所有的数据包进来的时候都先由这个链处理）</li>
<li>POSTROUTING——对数据包作路由选择后应用此链中的规则（所有的数据包出来的时候都先由这个链处理）</li>
</ol>
<h2 id="规则表之间的有限顺序"><a href="#规则表之间的有限顺序" class="headerlink" title="规则表之间的有限顺序"></a>规则表之间的有限顺序</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Raw——Mangle——Nat——Filter</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;规则链之间的优先顺序分三种情况</p>
<h3 id="1、入站数据流向"><a href="#1、入站数据流向" class="headerlink" title="1、入站数据流向"></a>1、入站数据流向</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;从外界达到防火墙的数据包，先被PREROUTING规则链处理（是否修改数据包地址等），之后会进行路由选择（判断该数据包应该发往何处），如果数据包的目标主机是防火墙本机（比如说internet用户访问防火墙主机中的web服务器的数据包）， 那么内核将其传给INPUT链进行处理（决定是否允许通过等），通过以后再给系统上层的应用程序（比如apache服务器）进行响应。</p>
<h3 id="2、转发数据流向"><a href="#2、转发数据流向" class="headerlink" title="2、转发数据流向"></a>2、转发数据流向</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;来自外界的数据包到达防火墙后，首先被PREROUTING规则链处理，之后会进行路由选择，如果数据包的目标地址是其他外部地址（比如局域网用户通过网关访问QQ站点的数据包），则内核将其传递给FPRWARD链进行处理（是否转发或拦截），然后再交给POSTROUTING规则链（是否修改数据包的地址等）进行处理。</p>
<h3 id="3、出站数据流向"><a href="#3、出站数据流向" class="headerlink" title="3、出站数据流向"></a>3、出站数据流向</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;防火墙本机向外部地下hi发送的数据包（比如在防火墙主机中测试公网DNS服务器时），首先被OUTPUT规则链处理，之后进行路由选择，然后传递给POSTROUTING规则链（是否修改数据包的地址等）进行处理。</p>
<h2 id="管理和设置iptables规则"><a href="#管理和设置iptables规则" class="headerlink" title="管理和设置iptables规则"></a>管理和设置iptables规则</h2><p><img src="https://github.com/hcldirgit/image/blob/master/iptables%E8%AF%A6%E8%A7%A3/03.jpg?raw=true" alt=""></p>
<p><img src="https://github.com/hcldirgit/image/blob/master/iptables%E8%AF%A6%E8%A7%A3/04.jpg?raw=true" alt=""></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;下面针对一个小需求讲述一下这个iptables规则如何设定：</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;需求：只针对filter表，预设策略INPUT链DROP，其他两个链ACCEPT，然后针对192.168.137.0/24开通22端口，对所有网段开放80端口，对素有网段开放21端口。这个需求不复制，但是有很多条规则，所以最好写成脚本形式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># vim /usr/local/sbin/iptables.sh</span></div><div class="line"></div><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"></div><div class="line">ipt=<span class="string">"/sbin/iptables"</span></div><div class="line"><span class="variable">$ipt</span> -F</div><div class="line"><span class="variable">$ipt</span> -P INPUT DROP</div><div class="line"><span class="variable">$ipt</span> -P OUTPUT ACCEPT</div><div class="line"><span class="variable">$ipt</span> -P FORWARD ACCEPR</div><div class="line"><span class="variable">$ipt</span> -A INPUT -s 192.168.137.0/24 -p tcp --dport 22 -j ACCEPT</div><div class="line"><span class="variable">$ipt</span> -A INPUT -p tcp --dport 80 -j ACCEPT</div><div class="line"><span class="variable">$ipt</span> -A INPUT -p tcp --dport 21 -j ACCEPT</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;完成脚本编写后，直接运行即可。如果想开机启动时初始化防火墙规则，需要在 <code>/etc/rc.d/rc.local</code> 中添加一行 <code>/bin/bash /usr/local/sbin/iptables.sh</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># sh /usr/local/sbin/iptables.sh</span></div><div class="line">[root@localhost ~]<span class="comment"># iptables -nvL</span></div><div class="line">Chain INPUT (policy DROP 0 packets, 0 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</div><div class="line">   20  1580 ACCEPT     tcp  --  *      *       192.168.137.0/24     0.0.0.0/0           tcp dpt:22</div><div class="line">    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80</div><div class="line">    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:21</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;运行脚本后，查看规则就是这样的，可以看到第一条规则中已经有20个包被放行了。关于icmp的包有一个比较常见的应用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@localhost ~]<span class="comment"># iptables -I INPUT -p icmp --icmp-type 8 -j DROP</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>–icmp-type 这个选项是要跟 -p icmp 一起使用的，后i安指定类型编号。这个8指的是能在本机ping同其他机器，而其他机器不能ping通本机。</strong></p>
<h2 id="nat表的应用"><a href="#nat表的应用" class="headerlink" title="nat表的应用"></a>nat表的应用</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;其实，linux的iptables功能是十分强大的，曾经有一个老师这样形容Linux的网络功能：只有想不到，没有做不到！也就是说只要能够想到的关于网络的应用，Linux都能实现。在日常生活中使用的路由器，它的功能就是分享上网。本来一跟网线过来（其实只有一个公网IP），通过路由器后，路由器分配了一个网段（私网IP），这样连接路由器的台机器都能连接internet，而远端的设备认为IP就是那个连接路由器的公网IP。这个路由器的功能其实就是有Linux的iptables实现的，而iptables又是通过nat表作用而实现的这个功能。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;举个例子来说明iptables如何实现的这个功能。假设机器上有两块网卡etho0和eth1，其中eth0的IP为10.0.2.68，eth1的IP为192.168.1.1.eth0连接了internet，但eth1没有连接，现在有另一台机器（192.168.1.2）和eth1是互通的，那么如何设置也能够让连接eth1的这台机器能够连接internet（即能和10.0.2.68互通）？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># echo "1" &gt; /proc/sys/net/ipv4/ip_forward</span></div><div class="line">[root@localhost ~]<span class="comment"># iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;就是这样简单的两条命令就能实现上面的需求。第一个命令涉及到了内核参数相关的配置文件，它的目的是为了打开路由转发功能，否则无法实现应用。第二个命令则是iptables对nat表做了一个IP转发的操作，-o选项后跟设备名，表示出口的网卡，MASQUERADE表示伪装的意思。</p>
<h2 id="iptables防火墙规则的保存与恢复"><a href="#iptables防火墙规则的保存与恢复" class="headerlink" title="iptables防火墙规则的保存与恢复"></a>iptables防火墙规则的保存与恢复</h2><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<code>iptables-save</code>把规则保存到文件中，再由目录rc.d下个脚本（/etc/rc.d/init.d/iptables）自动装载</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;使用命令<code>iptables-save</code>来保存规则。一般用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables-save &gt; /etc/sysconfig/iptables</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;生成保存规则的文件/etc/sysconfig/iptables,</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;也可以用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">service iptables save</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;它能把规则自动保存在/etc/sysconfig/iptables中。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;当计算机启动时，rc.d下的脚本将用命令iptables-restore调用这个文件，从而就自动恢复了规则。</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<code>-nvL</code>就是查看规则，<code>-F</code>是把当前规则清除，但这个只是临时的，重启系统或者重启iptables服务后还回加载已经保存的规则，所以需要使用<code>/etc/init.d/iptables save</code>保存一下规则</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -F ; /etc/init.d/iptables save</div></pre></td></tr></table></figure>
<h2 id="使用实例"><a href="#使用实例" class="headerlink" title="使用实例"></a>使用实例</h2><h3 id="实例1：查看规则以及清除规则"><a href="#实例1：查看规则以及清除规则" class="headerlink" title="实例1：查看规则以及清除规则"></a>实例1：查看规则以及清除规则</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -t nat -nvL</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -t nat -nvL</span></div><div class="line">Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line"></div><div class="line">Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line"></div><div class="line">Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<code>-t</code>后面跟表名，<code>-nvL</code>即查看该表的规则，其中<code>-n</code>表示不针对IP反解析主机名；<code>-L</code>表示列出的意思；而<code>-v</code>表示列出的信息更加详细。。如果不加<code>-t</code>，则打印<code>filter</code>表的相关信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -nvL</span></div><div class="line">Chain INPUT (policy ACCEPT 121 packets, 9013 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line"></div><div class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line"></div><div class="line">Chain OUTPUT (policy ACCEPT 85 packets, 8828 bytes)</div><div class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;这个和<code>-t filter</code>打印的信息是一样的。</p>
<h3 id="实例2：清除iptables规则"><a href="#实例2：清除iptables规则" class="headerlink" title="实例2：清除iptables规则"></a>实例2：清除iptables规则</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iptables -F</div><div class="line">iptables -Z</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;不加<code>-t</code>默认是针对表<code>filter</code>来操作的，<code>-F</code>表示把所有规则全部删除；<code>-Z</code>表示把包以及流量计数器清零。</p>
<h3 id="实例3：增加一条规则"><a href="#实例3：增加一条规则" class="headerlink" title="实例3：增加一条规则"></a>实例3：增加一条规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -A INPUT -s 10.72.11.12 -p tcp --sport 1234 -d 10.72.137.159 --dport 80 -j DROP</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;这就是增加一条规则，省略-t所以针对filter表。-A表示增加一条规则，另外还有-I表示插入一条规则，-D删除一条规则；后面个INPUT既链名称，还可以是OUTPUT或者FORWARD；-s后跟源地址；-p协议（tcp、udp、icmp）；<code>--sport/--dport</code>后跟源端口；-d后跟目的IP（主要针对内网或者外网）；-j后跟动作（DROP即把包丢掉，REJECT即包拒绝；ACCEPT即允许包）。</p>
<h3 id="实例4：插入一条规则，把来自1-1-1-1的所有数据包丢掉"><a href="#实例4：插入一条规则，把来自1-1-1-1的所有数据包丢掉" class="headerlink" title="实例4：插入一条规则，把来自1.1.1.1的所有数据包丢掉"></a>实例4：插入一条规则，把来自1.1.1.1的所有数据包丢掉</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -I INPUT -s 1.1.1.1 -j DROP</span></div></pre></td></tr></table></figure>
<h3 id="实例5：删除一条规则"><a href="#实例5：删除一条规则" class="headerlink" title="实例5：删除一条规则"></a>实例5：删除一条规则</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -D INPUT -s 1.1.1.1 -j DROP</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;删除实例4中插入的规则。注意要删除一条规则时，必须和插入的规则一致，也就是说两条iptables命令，除了-I和-D不一样外，其他地方都一样</p>
<h3 id="实例6：把来自2-2-2-2并且是tcp协议到本机80端口的数据包球吊"><a href="#实例6：把来自2-2-2-2并且是tcp协议到本机80端口的数据包球吊" class="headerlink" title="实例6：把来自2.2.2.2并且是tcp协议到本机80端口的数据包球吊"></a>实例6：把来自2.2.2.2并且是tcp协议到本机80端口的数据包球吊</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -I INPUT -s 2.2.2.2 -p tcp --dport 80 -j DROP</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;要注意的是<code>--dport/--sport</code>必须要和<code>-p</code>选项一起使用，否则会出错。</p>
<h3 id="实例7：把发送到10-0-1-14的22端口的数据包丢掉"><a href="#实例7：把发送到10-0-1-14的22端口的数据包丢掉" class="headerlink" title="实例7：把发送到10.0.1.14的22端口的数据包丢掉"></a>实例7：把发送到10.0.1.14的22端口的数据包丢掉</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -I OUTPUT -p tcp --dport 22 -d 10.0.1.14 -j DROP</span></div></pre></td></tr></table></figure>
<h3 id="实例8：把来自192-168-0-0-24这个网段的并且作用在eth0上的数据包都放行"><a href="#实例8：把来自192-168-0-0-24这个网段的并且作用在eth0上的数据包都放行" class="headerlink" title="实例8：把来自192.168.0.0/24这个网段的并且作用在eth0上的数据包都放行"></a>实例8：把来自192.168.0.0/24这个网段的并且作用在eth0上的数据包都放行</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -A INPUT -s 192.168.0.0/24 -i eth0 -j ACCEPT</span></div><div class="line">[root@localhost ~]<span class="comment"># iptables -nvL | grep '192.168.0.0/24'</span></div><div class="line">   65  4680 ACCEPT     all  --  eth0   *       192.168.0.0/24       0.0.0.0/0</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-I 和 -A 都是增加规则，它们的去区别是。 -A 可以说是往后排，-I 是直接插队到最前面。也就是说 -A 增加的规则是在最后面的，而 -I 增加的规则是在最前面的。数据包流向是从前往后走，所以如果想让一条规则最优先生效，那么就用 -I 插入一条规则。</p>
<h3 id="实例9：iptables删除某一条规则"><a href="#实例9：iptables删除某一条规则" class="headerlink" title="实例9：iptables删除某一条规则"></a>实例9：iptables删除某一条规则</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;iptables过多了，想删除某一条规则时，又不容易掌握当时创建时的规则。其实有一种比较简单的方法:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -nvL --line-numbers</span></div><div class="line">Chain INPUT (policy ACCEPT 12 packets, 648 bytes)</div><div class="line">num   pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line">1        0     0 DROP       tcp  --  *      *       2.2.2.2              0.0.0.0/0           tcp dpt:80 </div><div class="line">2      132  9309 ACCEPT     all  --  eth0   *       192.168.0.0/24       0.0.0.0/0           </div><div class="line"></div><div class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</div><div class="line">num   pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line"></div><div class="line">Chain OUTPUT (policy ACCEPT 90 packets, 8816 bytes)</div><div class="line">num   pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line">1        0     0 DROP       tcp  --  *      *       0.0.0.0/0            10.0.1.14           tcp dpt:22</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;删除某一条规则使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -D INPUT 2</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>-D后跟链名，然后是规则num，这个num就是查看iptables规则时第一列的值。</strong>再次查看刚才的规则，INPUT里已经没有第2条了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -nvL --line-numbers</span></div><div class="line">Chain INPUT (policy ACCEPT 7 packets, 504 bytes)</div><div class="line">num   pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line">1        0     0 DROP       tcp  --  *      *       2.2.2.2              0.0.0.0/0           tcp dpt:80 </div><div class="line"></div><div class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</div><div class="line">num   pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line"></div><div class="line">Chain OUTPUT (policy ACCEPT 5 packets, 604 bytes)</div><div class="line">num   pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination         </div><div class="line">1        0     0 DROP       tcp  --  *      *       0.0.0.0/0            10.0.1.14           tcp dpt:22</div></pre></td></tr></table></figure>
<h3 id="实例10：接收目标端口为22的数据包"><a href="#实例10：接收目标端口为22的数据包" class="headerlink" title="实例10：接收目标端口为22的数据包"></a>实例10：接收目标端口为22的数据包</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -i eth0 -p tcp --dport 22 -j ACCEPT</div></pre></td></tr></table></figure>
<h3 id="实例11：拒绝所有其他数据包"><a href="#实例11：拒绝所有其他数据包" class="headerlink" title="实例11：拒绝所有其他数据包"></a>实例11：拒绝所有其他数据包</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -j DROP</div></pre></td></tr></table></figure>
<h3 id="实例12：iptables-P选项"><a href="#实例12：iptables-P选项" class="headerlink" title="实例12：iptables -P选项"></a>实例12：iptables -P选项</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@localhost ~]<span class="comment"># iptables -P INPUT DROP</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-P选项经常用到，表示预设策略。 <strong>-P 后面跟链名，策略内容或者为DROP或者为ACCEPT，默认是ACCEPT。注意：如果在连接远程服务器，千万不要随便敲这个命令，因为一旦钓完回车就会断掉。</strong><br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>这个策略一旦设定后，只能使用 <code>iptables -P INPUT ACCEPT</code> 才能恢复成原始状态，而不能使用-F参数。</strong></p>
<h3 id="实例13：iptables实现内网机器访问外网"><a href="#实例13：iptables实现内网机器访问外网" class="headerlink" title="实例13：iptables实现内网机器访问外网"></a>实例13：iptables实现内网机器访问外网</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;环境：两台机器，一台可以访问外网、内网，一台只能访问内网</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;外网机器的外网IP：123.221.20.11；内网IP为：192.168.15.100</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;内网机器IP：192.168.15.101<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;设置方法：</p>
<ol>
<li>在外网机器上设置iptables规则：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -t nat -A POSTROUTING -s 192.168.15.101 -j SNAT --to 123.221.20.11</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>注意</strong> :如果想让整个内网的机器全部上网，只需要把 <code>-s 192.168.15.101</code> 换成 <code>-s 192.168.15.0/255.255.255.0</code> 即可</p>
<ol>
<li>在带外网机器上打开转发<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;首先查看是否已经打开</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># sysctl -a | grep 'net.ipv4.ip_forward'</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;如果值为1，则说明已经打开，否则需要修改匹配文件 <code>/etc/sysctl.conf</code></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;打开该配置文件，找到该参数，使其变为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">net.ipv4.ip_forward = 1</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;然后运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sysctl -p</div></pre></td></tr></table></figure>
<ol>
<li>在内网机器上，设置其网关为 192.168.15.100</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-eth0 </span></div><div class="line"></div><div class="line">GATEWAY=192.168.15.100</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;重启网络服务即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">service network restart</div></pre></td></tr></table></figure>
<ol>
<li>测试内网机器是否可以上网</li>
</ol>
<h3 id="实例14：iptables限制syn速度"><a href="#实例14：iptables限制syn速度" class="headerlink" title="实例14：iptables限制syn速度"></a>实例14：iptables限制syn速度</h3><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>原理</strong> ：每5s内tcp三次握手大于20次的属于不正常访问。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># iptables -A INPUT -s ! 192.168.0.0/255.255.255.0 -d 192.168.0.101 -p tcp -m tcp --dport 80 -m state --state NEW -m recent --set --name httpuser --rsource</span></div><div class="line">[root@localhost ~]<span class="comment"># iptables -A INPUT -m recent --update --seconds 5 --hitcount 20 --name httpuser --rsource -j DROP</span></div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong></p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;其中192.168.0.0/255.255.255.0为不受限制的网段，192.168.0.101 为本机IP。该iptables策略，可有效预防syn攻击，也可以有效防止机器人发垃圾贴。</p>
<h3 id="实例15：拒绝进入防火墙的所有ICMP协议数据包"><a href="#实例15：拒绝进入防火墙的所有ICMP协议数据包" class="headerlink" title="实例15：拒绝进入防火墙的所有ICMP协议数据包"></a>实例15：拒绝进入防火墙的所有ICMP协议数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -I INPUT -p icmp -j REJECT</div></pre></td></tr></table></figure>
<h3 id="实例16-允许防火墙转发除ICMP协议以外的所有数据包"><a href="#实例16-允许防火墙转发除ICMP协议以外的所有数据包" class="headerlink" title="实例16:允许防火墙转发除ICMP协议以外的所有数据包"></a>实例16:允许防火墙转发除ICMP协议以外的所有数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A FORWARD -p ! icmp -j ACCEPT</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：使用“!”可以将条件取反</p>
<h3 id="实例17：拒绝转发来自192-168-1-10主机的数据，允许转发来自192-168-0-0-24网段的数据"><a href="#实例17：拒绝转发来自192-168-1-10主机的数据，允许转发来自192-168-0-0-24网段的数据" class="headerlink" title="实例17：拒绝转发来自192.168.1.10主机的数据，允许转发来自192.168.0.0/24网段的数据"></a>实例17：拒绝转发来自192.168.1.10主机的数据，允许转发来自192.168.0.0/24网段的数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iptables -A FORWARD -s 192.168.1.11 -j REJECT</div><div class="line">iptables -A FORWARD -s 192.168.0.0/24 -j ACCEPT</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：注意要把拒绝的放在前面，不然就不起作用了。</p>
<h3 id="实例18：丢弃从外网接口（eth1）进入防火墙本机的源地址为私网地址的数据包"><a href="#实例18：丢弃从外网接口（eth1）进入防火墙本机的源地址为私网地址的数据包" class="headerlink" title="实例18：丢弃从外网接口（eth1）进入防火墙本机的源地址为私网地址的数据包"></a>实例18：丢弃从外网接口（eth1）进入防火墙本机的源地址为私网地址的数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -i eth1 -s 192.168.0.0/16 -j DROP</div><div class="line">iptables -A INPUT -i eth1 -s 172.16.0.0/12 -j DROP</div><div class="line">iptables -A INPUT -i eth1 -s 10.0.0.0.0/8 -j DROP</div></pre></td></tr></table></figure>
<h3 id="实例19：封堵网段（192-168-1-0-24），两小时后解封"><a href="#实例19：封堵网段（192-168-1-0-24），两小时后解封" class="headerlink" title="实例19：封堵网段（192.168.1.0/24），两小时后解封"></a>实例19：封堵网段（192.168.1.0/24），两小时后解封</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">iptables -I INPUT -s 10.20.30.0/24 -j DROP</div><div class="line">iptables -I FORWARD -s 10.20.30.0/24 -j DROP</div><div class="line">at now 2 hours at&gt; iptables -D INPUT 1 at&gt; iptables -D FORWARD 1</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：这个策略借助crontab计划任务来完成，就再好不过了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[1]  Stopped  at now 2 hours</div></pre></td></tr></table></figure>
<h3 id="实例20：只允许管理员从202-13-0-0-16网段使用SSH远程登录防火墙主机"><a href="#实例20：只允许管理员从202-13-0-0-16网段使用SSH远程登录防火墙主机" class="headerlink" title="实例20：只允许管理员从202.13.0.0/16网段使用SSH远程登录防火墙主机"></a>实例20：只允许管理员从202.13.0.0/16网段使用SSH远程登录防火墙主机</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -p tcp --dport 22 -s 202.13.0.0/16 -j ACCEPT</div><div class="line">iptables -A INPUT -p tcp --dport 22 -j DROP</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：这个用法比较适合对设备进行远程管理时使用，比如位于分公司中的SQL服务器需要被总公司的管理员管理时。</p>
<h3 id="实例21：允许本机开放从TCP端口20-1024提供的应用服务"><a href="#实例21：允许本机开放从TCP端口20-1024提供的应用服务" class="headerlink" title="实例21：允许本机开放从TCP端口20-1024提供的应用服务"></a>实例21：允许本机开放从TCP端口20-1024提供的应用服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -p tcp --dport 20:1024 -j ACCEPT</div><div class="line">iptables -A INPUT -p tcp --sport 20:1024 -j ACCEPT</div></pre></td></tr></table></figure>
<h3 id="实例22：允许转发来自192-168-0-0-24局域网的DNS解析请求数据包"><a href="#实例22：允许转发来自192-168-0-0-24局域网的DNS解析请求数据包" class="headerlink" title="实例22：允许转发来自192.168.0.0/24局域网的DNS解析请求数据包"></a>实例22：允许转发来自192.168.0.0/24局域网的DNS解析请求数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iptables -A FORWARD -s 192.168.0.0/24 -p udp --dport 53 -j ACCEPT</div><div class="line">iptables -A FORWARD -s 192.168.0.0/24 -p udp --sport 53 -j ACCEPT</div></pre></td></tr></table></figure>
<h3 id="实例23：禁止其他主机ping防火墙主机，但是允许防火墙上ping其他主机"><a href="#实例23：禁止其他主机ping防火墙主机，但是允许防火墙上ping其他主机" class="headerlink" title="实例23：禁止其他主机ping防火墙主机，但是允许防火墙上ping其他主机"></a>实例23：禁止其他主机ping防火墙主机，但是允许防火墙上ping其他主机</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">iptables -I INPUT -p icmp --icmp-type Echo-Request -j DROP</div><div class="line">iptables -I INPUT -p icmp --icmp-type Echo-Reply -j ACCEPT</div><div class="line">iptables -I INPUT -p icmp --icmp-type destination-Unreachable -j ACCEPT</div></pre></td></tr></table></figure>
<h3 id="实例24：禁止转发来自MAC地址为00-0C-29-27-55-3F的和主机的数据包"><a href="#实例24：禁止转发来自MAC地址为00-0C-29-27-55-3F的和主机的数据包" class="headerlink" title="实例24：禁止转发来自MAC地址为00:0C:29:27:55:3F的和主机的数据包"></a>实例24：禁止转发来自MAC地址为00:0C:29:27:55:3F的和主机的数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A FORWARD -m mac --mac-source 00:0c:29:27:55:3f -j DROP</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> :iptables<br>中使用 <code>-m 模块关键字</code> 的形式调用显示匹配。这里用 <code>-m mac --mac-source</code>来表示数据包的源MAC地址。</p>
<h3 id="实例25：允许防火墙本机对外开放TCP端口-20、21、25、110以及被动模式FTP端口1250-1280"><a href="#实例25：允许防火墙本机对外开放TCP端口-20、21、25、110以及被动模式FTP端口1250-1280" class="headerlink" title="实例25：允许防火墙本机对外开放TCP端口 20、21、25、110以及被动模式FTP端口1250-1280"></a>实例25：允许防火墙本机对外开放TCP端口 20、21、25、110以及被动模式FTP端口1250-1280</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -p tcp -m multiport --dport 20,21,25,110,1250:1280 -j ACCEPT</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：这里使用 <code>-m multiport -dport</code> 来指定目的端口及范围</p>
<h3 id="实例26：禁止转发源IP地址为192-168-1-20-192-168-1-99的TCP数据包"><a href="#实例26：禁止转发源IP地址为192-168-1-20-192-168-1-99的TCP数据包" class="headerlink" title="实例26：禁止转发源IP地址为192.168.1.20-192.168.1.99的TCP数据包"></a>实例26：禁止转发源IP地址为192.168.1.20-192.168.1.99的TCP数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A FORWARD -p tcp -m iprange --src-range 192.168.1.20-192.168.1.99 -j DROP</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：此处用 <code>-m -iprange --src-range</code>指定IP范围</p>
<h3 id="实例27：禁止转发与正常TCP连接无关的非-syn请求数据包"><a href="#实例27：禁止转发与正常TCP连接无关的非-syn请求数据包" class="headerlink" title="实例27：禁止转发与正常TCP连接无关的非-syn请求数据包"></a>实例27：禁止转发与正常TCP连接无关的非-syn请求数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A FORWARD -m state --state NEW -p tcp ! --syn -j DROP</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：<code>-m state</code> 表示数据包的俩节状态，NEW表示与任何 连接无关的，新的嘛！</p>
<h3 id="实例28：拒绝访问防火墙的新数据包，但允许响应连接或与已有连接相关的数据包"><a href="#实例28：拒绝访问防火墙的新数据包，但允许响应连接或与已有连接相关的数据包" class="headerlink" title="实例28：拒绝访问防火墙的新数据包，但允许响应连接或与已有连接相关的数据包"></a>实例28：拒绝访问防火墙的新数据包，但允许响应连接或与已有连接相关的数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -p tcp -m state --state NEW -j DROP</div><div class="line">iptables -A INPUT -p tcp -m state --state ESTABLISHED,RELATED -j ACCEPT</div></pre></td></tr></table></figure>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <strong>说明</strong> ：<code>ESTABLISHED</code> 表示已经响应请求或者已经建立连接的数据包，<code>RELATED</code> 表示与已建立的连接有相关性的，比如FTP数据连接等。</p>
<h3 id="实例29：只开放本机的web服务（80）、FTP（20、21、20340-20480），放行外部主机发往服务器其他端口的应答数据包，将其他入站数据包均以丢弃处理"><a href="#实例29：只开放本机的web服务（80）、FTP（20、21、20340-20480），放行外部主机发往服务器其他端口的应答数据包，将其他入站数据包均以丢弃处理" class="headerlink" title="实例29：只开放本机的web服务（80）、FTP（20、21、20340-20480），放行外部主机发往服务器其他端口的应答数据包，将其他入站数据包均以丢弃处理"></a>实例29：只开放本机的web服务（80）、FTP（20、21、20340-20480），放行外部主机发往服务器其他端口的应答数据包，将其他入站数据包均以丢弃处理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">iptables -I INPUT -p tcp -m multiport --dport 20,21,80 -j ACCEPT</div><div class="line">iptables -I INPUT -p tcp --dport 2045:20480 -j ACCEPT</div><div class="line">iptables -I INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT</div><div class="line">iptables -P INPUT DROP</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux命令/">Linux命令</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/45/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="page-number" href="/page/45/">45</a><span class="page-number current">46</span><a class="page-number" href="/page/47/">47</a><a class="page-number" href="/page/48/">48</a><span class="space">&hellip;</span><a class="page-number" href="/page/63/">63</a><a class="extend next" rel="next" href="/page/47/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 失落的乐章
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    

<script>
	var yiliaConfig = {
		fancybox: ,
		mathjax: ,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



  </div>
</body>
</html>